<!DOCTYPE html>
<html lang="ne">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡§ú‡§ó‡•ç‡§ó‡§æ ‡§¶‡§∞‡•ç‡§§‡§æ ‡§∏‡§Æ‡§ø‡§§‡§ø‡§ï‡•ã ‡§∏‡§ø‡§´‡§æ‡§∞‡§ø‡§∏ - acharyasuman4</title>
    <style>
        /* GENERAL RESET */
        body, html {
            margin: 0;
            padding: 0;
            height: 100%;
            font-family: 'Kalimati', 'Arial', sans-serif;
            background-color: #eef2f5;
            box-sizing: border-box;
        }

        /* SPLIT SCREEN LAYOUT */
        .main-container {
            display: flex;
            height: 100vh;
            overflow: hidden;
        }

        /* LEFT: INPUT FORM */
        .form-pane {
            flex: 1;
            min-width: 480px;
            overflow-y: auto;
            background: #ffffff;
            padding: 20px;
            box-shadow: 2px 0 5px rgba(0,0,0,0.1);
            border-right: 1px solid #ddd;
            z-index: 10;
        }

/* RIGHT: PREVIEW - Updated for better scrolling */
.preview-pane {
    flex: 1.3;
    background: #525659;
    padding: 30px;
    /* Allows the gray background to scroll if paper is very long */
    overflow-y: auto; 
    display: flex;
    justify-content: center;
    align-items: flex-start; /* Aligns paper to top */
}

/* A4 PAPER ON SCREEN - Updated to grow automatically */
#print-preview {
    background: white;
    width: 210mm;
    min-height: 297mm; 
    height: auto; /* IMPORTANT: Allows paper to grow for 2nd/3rd page */
    padding: 20mm 12.7mm 20mm 35mm; 
    box-shadow: 0 0 15px rgba(0,0,0,0.5);
    box-sizing: border-box;
    font-size: 14px;
    line-height: 1.5;
    color: #000;
    margin-bottom: 50px; /* Space at bottom for scrolling */
}
        /* FORM ELEMENTS */
        h2.form-header { color: #2c3e50; border-bottom: 2px solid #3498db; padding-bottom: 5px; margin-top: 0; }
        h3 { color: #2c3e50; font-size: 15px; margin-top: 15px; border-bottom: 1px solid #eee; background: #f9f9f9; padding: 5px; }
        
        .form-group { margin-bottom: 10px; }
        label { display: block; font-weight: 600; font-size: 13px; margin-bottom: 3px; color: #444; }
        
        input[type="text"], select, textarea {
            width: 100%;
            padding: 6px 8px;
            border: 1px solid #ccc;
            border-radius: 4px;
            font-family: inherit;
            box-sizing: border-box;
            font-size: 13px;
        }
        input:focus, select:focus, textarea:focus { border-color: #3498db; outline: none; background: #f0f8ff; }

        .row { display: flex; gap: 10px; }
        .col { flex: 1; }
        
        /* TABLE STYLES */
        .input-table, .result-table { width: 100%; border-collapse: collapse; font-size: 13px; margin-bottom: 5px; }
        
        /* Form Table */
        .input-table th { background: #f1f1f1; text-align: left; padding: 4px; border: 1px solid #ddd; }
        .input-table td { padding: 2px; border: 1px solid #ddd; }
        .input-table input { border: none; padding: 5px; width: 100%; }

        /* Print Table */
        .result-table th, .result-table td {
            border: 1px solid #000;
            padding: 4px 6px;
            vertical-align: top;
            text-align: left;
        }
        .result-table th { background-color: #f0f0f0; font-weight: bold; text-align: center; }

        /* BUTTONS */
        .btn-group { margin-top: 5px; margin-bottom: 15px; }
        .btn { padding: 5px 10px; border: none; border-radius: 3px; cursor: pointer; color: white; margin-right: 5px; }
        .btn-green { background-color: #27ae60; }
        .btn-blue { background-color: #2980b9; }
        .btn-red { background-color: #c0392b; }
        .btn-print { background-color: #34495e; font-size: 16px; padding: 12px; width: 100%; margin-top: 20px; font-weight: bold; }
        .btn-word { background-color: #2c3e50; font-size: 16px; padding: 12px; width: 100%; margin-top: 10px; font-weight: bold; }

        .bold-text { font-weight: bold; }
        .hidden { display: none; }
        
        /* Kitta Selector Box */
        .kitta-box {
            border: 1px solid #ccc;
            padding: 10px;
            background: #fff;
            margin-top: 5px;
            max-height: 150px;
            overflow-y: auto;
        }
        .kitta-item { display: inline-block; margin-right: 10px; font-size: 12px; }

        /* PRINT MEDIA QUERY */
        @media print {
            /* Hide the UI, Show the Paper */
            .form-pane { display: none !important; }
            .preview-pane { display: block !important; padding: 0 !important; background: white !important; overflow: visible !important; }
            .main-container { display: block !important; height: auto !important; overflow: visible !important; }
            
            body, html { height: auto !important; overflow: visible !important; background: white !important; }

            #print-preview {
                width: 100% !important;
                height: auto !important;
                box-shadow: none !important;
                margin: 0 !important;
                padding: 0 !important; /* Padding handled by @page */
                border: none !important;
            }

            /* Page Margins: Top Right Bottom Left */
            @page {
                size: A4;
                margin: 20mm 12.7mm 20mm 35mm; /* 0.5in Right = 12.7mm */
            }
        }
    </style>
</head>
<body>

<div class="main-container">
    <!-- LEFT SIDE: INPUT FORM -->
    <div class="form-pane">
        <h2 class="form-header">‡§ú‡§ó‡•ç‡§ó‡§æ ‡§¶‡§∞‡•ç‡§§‡§æ ‡§∏‡§ø‡§´‡§æ‡§∞‡§ø‡§∏ ‡§´‡§æ‡§∞‡§Æ</h2>
        
        <div style="background:#e3f2fd; padding:10px; border-radius:5px; margin-bottom:15px; border:1px solid #b3e5fc;">
            <label>‡§®‡§ø‡§µ‡•á‡§¶‡§® ‡§™‡•ç‡§∞‡§ï‡§æ‡§∞:</label>
            <input type="radio" name="req_type" value="‡§¶‡§∞‡•ç‡§§‡§æ" checked onchange="updatePreview()"> ‡§õ‡•Å‡§ü ‡§ú‡§ó‡•ç‡§ó‡§æ ‡§¶‡§∞‡•ç‡§§‡§æ
            <input type="radio" name="req_type" value="‡§®‡§æ‡§Æ‡§∏‡§æ‡§∞‡•Ä ‡§¶‡§∞‡•ç‡§§‡§æ" onchange="updatePreview()" style="margin-left:15px;"> ‡§®‡§æ‡§Æ‡§∏‡§æ‡§∞‡•Ä ‡§¶‡§∞‡•ç‡§§‡§æ
        </div>

        <div class="row form-group">
            <div class="col">
                <label>‡§Æ‡§ø‡§§‡§ø (YYYY.MM.DD):</label>
                <input type="text" id="date" value="" placeholder="‡•®‡•¶‡•Æ‡•®.‡•¶‡•ß.‡•¶‡•®" oninput="updatePreview()">
            </div>
            <div class="col"><label>‡§¶‡§∞‡•ç‡§§‡§æ ‡§®‡§Ç.:</label><input type="text" id="reg_no" oninput="updatePreview()"></div>
        </div>

        <div class="form-group">
            <label>‡§µ‡§ø‡§∑‡§Ø:</label>
            <select id="subject_opt" onchange="checkSubject(); updatePreview()">
                <option value="‡§õ‡•Å‡§ü ‡§ú‡§ó‡•ç‡§ó‡§æ ‡§¶‡§∞‡•ç‡§§‡§æ ‡§ó‡§∞‡•Ä ‡§ú.‡§ß. ‡§™‡•ç‡§∞‡§Æ‡§æ‡§£‡§™‡•Å‡§∞‡•ç‡§ú‡§æ ‡§™‡§æ‡§â‡§Å ‡•§">‡§õ‡•Å‡§ü ‡§ú‡§ó‡•ç‡§ó‡§æ ‡§¶‡§∞‡•ç‡§§‡§æ ‡§ó‡§∞‡•Ä ‡§ú.‡§ß. ‡§™‡•ç‡§∞‡§Æ‡§æ‡§£‡§™‡•Å‡§∞‡•ç‡§ú‡§æ ‡§™‡§æ‡§â‡§Å ‡•§</option>
                <option value="custom">‡§Ö‡§®‡•ç‡§Ø ‡§≤‡•á‡§ñ‡•ç‡§®‡•Å‡§π‡•ã‡§∏‡•ç</option>
            </select>
            <input type="text" id="subject_custom" class="hidden" style="margin-top:5px;" placeholder="‡§µ‡§ø‡§∑‡§Ø ‡§≤‡•á‡§ñ‡•ç‡§®‡•Å‡§π‡•ã‡§∏‡•ç" oninput="updatePreview()">
        </div>

        <h3>‡•ß. ‡§®‡§ø‡§µ‡•á‡§¶‡§ï‡§ï‡•ã ‡§µ‡§ø‡§µ‡§∞‡§£</h3>
        <div class="row form-group">
            <div class="col"><label>‡§®‡§æ‡§Æ ‡§•‡§∞:</label><input type="text" id="app_name" oninput="updateDatalist(); updatePreview()"></div>
            <div class="col"><label>‡§µ‡§§‡§®:</label><input type="text" id="app_addr" oninput="updatePreview()"></div>
        </div>
        <div class="row form-group">
            <div class="col"><label>‡§®‡§æ.‡§™‡•ç‡§∞.‡§®‡§Ç.:</label><input type="text" id="app_citizenship" oninput="updatePreview()"></div>
            <div class="col"><label>‡§ú‡§æ‡§∞‡•Ä ‡§ú‡§ø‡§≤‡•ç‡§≤‡§æ:</label><input type="text" id="app_district" value="‡§∏‡§ø‡§®‡•ç‡§ß‡•Å‡§™‡§æ‡§≤‡•ç‡§ö‡•ã‡§ï" oninput="updatePreview()"></div>
            <div class="col"><label>‡§ú‡§æ‡§∞‡•Ä ‡§Æ‡§ø‡§§‡§ø:</label><input type="text" id="app_c_date" oninput="updatePreview()"></div>
        </div>
        <div class="row form-group">
            <div class="col" style="flex:0.4;">
                <select id="rel_type_1" onchange="updatePreview()"><option value="‡§¨‡§æ‡§¨‡•Å">‡§¨‡§æ‡§¨‡•Å‡§ï‡•ã ‡§®‡§æ‡§Æ</option><option value="‡§™‡§§‡§ø">‡§™‡§§‡§ø‡§ï‡•ã ‡§®‡§æ‡§Æ</option></select>
            </div>
            <div class="col"><input type="text" id="app_father" oninput="updatePreview()"></div>
        </div>
        <div class="row form-group">
            <div class="col" style="flex:0.4;">
                <select id="rel_type_2" onchange="updatePreview()"><option value="‡§¨‡§æ‡§ú‡•á">‡§¨‡§æ‡§ú‡•á‡§ï‡•ã ‡§®‡§æ‡§Æ</option><option value="‡§∏‡§∏‡•Å‡§∞‡§æ">‡§∏‡§∏‡•Å‡§∞‡§æ‡§ï‡•ã ‡§®‡§æ‡§Æ</option></select>
            </div>
            <div class="col"><input type="text" id="app_grandfather" oninput="updatePreview()"></div>
        </div>

        <h3>‡•®. ‡§π‡§ï‡§¶‡§æ‡§∞ ‡§µ‡§ø‡§µ‡§∞‡§£ (‡§®‡§æ‡§Æ‡§∏‡§æ‡§∞‡•Ä ‡§≠‡§è‡§Æ‡§æ)</h3>
        <div class="row form-group">
            <div class="col"><label>‡§∏‡§æ‡§µ‡§ø‡§ï ‡§¶‡§∞‡•ç‡§§‡§æ‡§µ‡§æ‡§≤‡§æ‡§ï‡•ã ‡§®‡§æ‡§Æ:</label><input type="text" id="old_owner_name" oninput="updateDatalist(); updatePreview()"></div>
            <div class="col"><label>‡§µ‡§§‡§®:</label><input type="text" id="old_owner_addr" oninput="updatePreview()"></div>
        </div>
        <div class="form-group"><label>‡§π‡§ï‡§¶‡§æ‡§∞ ‡§™‡•ç‡§∞‡§Æ‡§æ‡§£:</label><input type="text" id="heir_proof" value="" oninput="updatePreview()"></div>
        
        <label>‡§π‡§ï‡§¶‡§æ‡§∞‡§π‡§∞‡•Å‡§ï‡•ã ‡§§‡§æ‡§≤‡§ø‡§ï‡§æ:</label>
        <table class="input-table" id="heir_table">
            <thead><tr><th width="30%">‡§®‡§æ‡§§‡§æ</th><th>‡§®‡§æ‡§Æ‡§•‡§∞</th><th width="30%">‡§ï‡•à‡§´‡§ø‡§Ø‡§§</th><th></th></tr></thead>
            <tbody></tbody>
        </table>
        <datalist id="person_list"></datalist>
        <div class="btn-group"><button class="btn btn-green" onclick="addHeirRow()">+ Add Row</button></div>
        <div class="form-group"><label>‡§ò. ‡§Ö‡§®‡•ç‡§Ø ‡§π‡§ï‡§¶‡§æ‡§∞‡§≤‡•á ‡§π‡§ï ‡§õ‡•ã‡§°‡•á‡§ï‡•ã‡§Æ‡§æ ‡§®‡§æ‡§Æ:</label><input type="text" id="heir_consent" value="‡§õ‡•à‡§®" oninput="updatePreview()"></div>

        <h3>‡•©. ‡§ú‡§ó‡•ç‡§ó‡§æ‡§ï‡•ã ‡§µ‡§ø‡§µ‡§∞‡§£</h3>
        <div class="row form-group">
            <div class="col"><label>‡§∞.‡§®‡§Ç./‡§π‡§æ.‡§®‡§Ç. (‡§è‡§ï‡§≠‡§®‡•ç‡§¶‡§æ ‡§¨‡§¢‡§ø ‡§≠‡§è ‡§ï‡§Æ‡§æ ‡§¶‡§ø‡§è‡§∞):</label><input type="text" id="land_rec_no" oninput="updatePreview()"></div>
        </div>
        <table class="input-table" id="land_table">
            <thead>
                <tr>
                    <th>‡§Æ‡•å‡§ú‡§æ/‡§ó‡§æ.‡§µ‡§ø.‡§∏.</th><th width="40px">‡§µ‡§°‡§æ</th><th width="40px">‡§ï‡§ø.‡§®‡§Ç.</th><th width="50px">‡§ï‡•ç‡§∑‡•á.‡§´.</th>
                    <th>‡§ñ‡§≤‡•ã</th><th>‡§µ‡§ø‡§∞‡§π</th><th>‡§ï‡§ø‡§∏‡§ø‡§Æ</th><th>‡§™‡•ç‡§∞‡§ï‡•É‡§§‡§ø</th><th></th>
                </tr>
            </thead>
            <tbody></tbody>
        </table>
        <div class="btn-group">
            <button class="btn btn-blue" onclick="addSameGavisa()">+ Add (Same Gavisa)</button>
            <button class="btn btn-green" onclick="addNewGavisa()">+ Add (New Gavisa)</button>
        </div>

        <h3>‡§Ö‡§®‡•ç‡§Ø ‡§µ‡§ø‡§µ‡§∞‡§£</h3>
        <div class="form-group"><label>‡•™. ‡•≠ ‡§®‡§Ç. ‡§´‡§æ‡§Å‡§ü‡§µ‡§æ‡§∞‡•Ä ‡§≠‡§ø‡§°‡•ç‡§õ?</label><input type="text" id="q4" value="‡§≠‡§ø‡§°‡•ç‡§õ ‡•§" oninput="updatePreview()"></div>
        <div class="form-group"><label>‡•´. ‡§•‡§™ ‡§™‡•ç‡§∞‡§Æ‡§æ‡§£ (‡§´‡§ø‡§≤‡•ç‡§°‡§¨‡•Å‡§ï... ‡§¨‡§æ‡§π‡•á‡§ï):</label><input type="text" id="q5_extra" placeholder="‡§õ‡•à‡§®" oninput="updatePreview()"></div>
        <div class="form-group"><label>‡•¨. ‡§¨‡§æ‡§Å‡§ï‡•Ä ‡§¶‡§∞‡•ç‡§§‡§æ ‡§µ‡§ø‡§µ‡§∞‡§£:</label><input type="text" id="q6" value="‡§õ‡•à‡§®" oninput="updatePreview()"></div>
        <div class="form-group"><label>‡•≠. ‡§™‡§π‡§ø‡§≤‡•á ‡§®‡§ø‡§µ‡•á‡§¶‡§® ‡§¶‡§ø‡§è‡§ï‡•ã ‡§≠‡§è‡§ï‡•ã ‡§≠‡§è‡§ï‡•ã ‡§ï‡§æ‡§∞‡§µ‡§æ‡§π‡•Ä‡§ï‡•ã ‡§µ‡•ç‡§Ø‡§π‡•ã‡§∞‡§æ:</label><input type="text" id="q7" value="‡§õ‡•à‡§®" oninput="updatePreview()"></div>
        <div class="form-group"><label>8. ‡§Æ‡§æ‡§≤‡§™‡•ã‡§§/‡§ß‡§∞‡•å‡§ü‡•Ä:</label><input type="text" id="q8" value="‡§§‡§ø‡§∞‡•ã ‡§Æ‡§ø‡§∏‡§ø‡§≤ ‡§∏‡§Ç‡§≤‡§ó‡•ç‡§® ‡§õ ‡•§ ‡§ß‡§∞‡•å‡§ü‡•Ä ‡§µ‡§ø‡§µ‡§∞‡§£ ‡§õ‡•à‡§®" oninput="updatePreview()"></div>

        <h3>‡•Ø. ‡§ï‡§æ‡§∞‡•ç‡§Ø‡§æ‡§≤‡§Ø‡§ï‡•ã ‡§∂‡•ç‡§∞‡•á‡§∑‡•ç‡§§‡§æ</h3>
        
        <!-- Mohi Logic -->
        <div class="form-group" style="background:#f9f9f9; padding:5px; border:1px solid #ddd;">
            <label>‡§Æ‡•ã‡§π‡•Ä ‡§µ‡§ø‡§µ‡§∞‡§£:</label>
            <input type="radio" name="mohi_opt" value="chhaina" checked onchange="toggleMohi()"> ‡§õ‡•à‡§®
            <input type="radio" name="mohi_opt" value="chha" onchange="toggleMohi()"> ‡§õ
            <div id="mohi_section" class="hidden">
                <input type="text" id="mohi_name" placeholder="‡§Æ‡•ã‡§π‡•Ä‡§ï‡•ã ‡§®‡§æ‡§Æ" oninput="updatePreview()" style="margin-top:5px;">
                <div style="font-size:11px; margin-top:3px; color:#666;">‡§Æ‡•ã‡§π‡•Ä ‡§≤‡§æ‡§ó‡•ç‡§®‡•á ‡§ï‡§ø‡§§‡•ç‡§§‡§æ‡§π‡§∞‡•Å ‡§õ‡§æ‡§®‡•ç‡§®‡•Å‡§π‡•ã‡§∏‡•ç:</div>
                <div id="mohi_kitta_container" class="kitta-box"></div>
            </div>
        </div>

        <!-- Jhagada Logic -->
        <div class="form-group" style="background:#f9f9f9; padding:5px; border:1px solid #ddd;">
            <label>‡§ù‡§ó‡§°‡§æ ‡§µ‡§ø‡§µ‡§∞‡§£:</label>
            <input type="radio" name="jhagada_opt" value="chhaina" checked onchange="toggleJhagada()"> ‡§õ‡•à‡§®
            <input type="radio" name="jhagada_opt" value="chha" onchange="toggleJhagada()"> ‡§õ
            <div id="jhagada_section" class="hidden">
                <div style="font-size:11px; margin-top:3px; color:#666;">‡§ù‡§ó‡§°‡§æ ‡§≠‡§è‡§ï‡§æ ‡§ï‡§ø‡§§‡•ç‡§§‡§æ‡§π‡§∞‡•Å ‡§õ‡§æ‡§®‡•ç‡§®‡•Å‡§π‡•ã‡§∏‡•ç:</div>
                <div id="jhagada_kitta_container" class="kitta-box"></div>
            </div>
        </div>

        <div class="row form-group">
            <div class="col"><label>‡§Æ‡•ã‡§† ‡§µ‡§ø‡§µ‡§∞‡§£:</label><input type="text" id="moth_desc" value="‡§õ‡•à‡§®" oninput="updatePreview()"></div>
            <div class="col"><label>‡§∞‡•ã‡§ï‡•ç‡§ï‡§æ:</label><input type="text" id="rocca_desc" value="‡§õ‡•à‡§®" oninput="updatePreview()"></div>
        </div>
        <div class="row form-group">
            <div class="col"><label>‡§∏‡§æ‡§µ‡§ø‡§ï ‡§≤‡§ó‡§§:</label><input type="text" id="sabik_desc" value="‡§õ" oninput="updatePreview()"></div>
            <div class="col"><label>‡§≤‡•Å‡§ú‡§∏‡•Ä‡§ü ‡§≠‡§ø‡§°‡•á‡§ï‡•ã:</label><select id="loose_sheet" onchange="updatePreview()"><option value="‡§õ">‡§õ</option><option value="‡§õ‡•à‡§®">‡§õ‡•à‡§®</option></select></div>
        </div>

        <h3>‡•ß‡•¶-‡•®‡•®. ‡§∏‡§ø‡§´‡§æ‡§∞‡§ø‡§∏ ‡§§‡§•‡§æ ‡§∞‡§æ‡§Ø</h3>
        <div class="form-group"><label>‡•ß‡•¶. ‡§∏‡•ç‡§•‡§æ‡§®‡•Ä‡§Ø ‡§§‡§π ‡§∏‡§ø‡§´‡§æ‡§∞‡§ø‡§∏:</label><textarea rows="2" id="q10" oninput="updatePreview()">‡§®‡§ø‡§µ‡•á‡§¶‡§ï‡§≤‡•á ‡§π‡§ï‡§≠‡•ã‡§ó ‡§ó‡§∞‡•Ä ‡§Ü‡§è‡§ï‡•ã ‡§ú‡§ó‡•ç‡§ó‡§æ ‡§¶‡§∞‡•ç‡§§‡§æ ‡§π‡•Å‡§® ‡§õ‡•Å‡§ü ‡§≠‡§è‡§ï‡•ã‡§≤‡•á ‡§®‡§ø‡§Ø‡§Æ‡§æ‡§®‡•Å‡§∏‡§æ‡§∞ ‡§ó‡§∞‡•Ä ‡§¶‡§ø‡§®‡•Ç ‡•§</textarea></div>
        <div class="form-group"><label>‡•ß‡•ß. ‡§∏‡§∞‡•ç‡§ú‡§Æ‡§ø‡§®‡§ï‡•ã ‡§≠‡§®‡§æ‡§á:</label><textarea rows="2" id="q11" oninput="updatePreview()">‡§∏‡§æ‡§¨‡§ø‡§ï ‡§∏‡§Æ‡§Ø ‡§¶‡•á‡§ñ‡§ø‡§ï‡•ã ‡§π‡§ï‡§≠‡•ã‡§ó ‡§≠‡§ø‡§§‡•ç‡§∞‡§ï‡•ã ‡§®‡§Æ‡•ç‡§¨‡§∞‡•Ä ‡§ú‡§ó‡•ç‡§ó‡§æ ‡§Ø‡•Ä ‡§®‡§ø‡§µ‡•á‡§¶‡§ï‡§ï‡§æ ‡§®‡§æ‡§â‡§Å‡§Æ‡§æ ‡§¶‡§∞‡•ç‡§§‡§æ ‡§ó‡§∞‡•Ä ‡§¶‡§ø‡§è ‡§´‡§∞‡§ï ‡§™‡§∞‡•ç‡§¶‡•à‡§® ‡•§</textarea></div>
        <div class="form-group"><label>‡•ß‡•®. ‡§∏‡•ç‡§•‡§≤‡§ó‡§§ ‡§®‡•Ä‡§∞‡§ø‡§ï‡•ç‡§∑‡§£:</label><textarea rows="2" id="q12" placeholder="‡§∏‡•ç‡§•‡§≤‡§ó‡§§ ‡§®‡§ø‡§∞‡•Ä‡§ï‡•ç‡§∑‡§£‡§¨‡§æ‡§ü..." oninput="updatePreview()"></textarea></div>
        <div class="form-group"><label>‡•ß‡•´. ‡§∏‡•Ç‡§ö‡§®‡§æ ‡§µ‡§ø‡§µ‡§∞‡§£:</label><textarea rows="3" id="q15" oninput="updatePreview()">‡§∏‡§∞‡§ï‡§æ‡§∞‡•Ä ‡§∏‡§æ‡§∞‡•ç‡§µ‡§ú‡§®‡§ø‡§ï ‡§ê‡§≤‡§æ‡§®‡•Ä ‡§™‡§∞‡•ç‡§§‡•Ä ‡§ó‡•Å‡§†‡•Ä ‡§µ‡•ç‡§Ø‡§ï‡•ç‡§§‡§ø ‡§¨‡§ø‡§∂‡•á‡§∑‡§ï‡•ã ‡§π‡§ï ‡§≤‡§æ‡§ó‡•ç‡§®‡•á ‡§ú‡§ó‡•ç‡§ó‡§æ ‡§≠‡§è ‡§µ‡§æ ‡§∏‡•ã ‡§™‡•ç‡§∞‡§ï‡§æ‡§∞‡§ï‡§æ ‡§ú‡§ó‡•ç‡§ó‡§æ ‡§∏‡§Æ‡•á‡§§ ‡§®‡§æ‡§™ ‡§®‡§ï‡•ç‡§∏‡§æ ‡§µ‡§æ ‡§≠‡•ã‡§ó ‡§∏‡§Æ‡•á‡§§ ‡§ó‡§∞‡•á‡§ï‡•ã ‡§≠‡§è ‡§¶‡§æ‡§¨‡•Ä ‡§¨‡§ø‡§∞‡•ã‡§ß ‡§ó‡§∞‡•ç‡§®‡•Å ‡§π‡•Å‡§® ‡§≠‡§®‡•Ä ‡§∞‡§æ‡§∑‡•ç‡§ü‡•ç‡§∞‡§ø‡§Ø ‡§¶‡•à‡§®‡§ø‡§ï ‡§™‡§§‡•ç‡§∞‡§ø‡§ï‡§æ ‡§∏‡§Æ‡•á‡§§‡§Æ‡§æ ‡•©‡•´ ‡§¶‡§ø‡§®‡•á ‡§π‡§ï‡§¶‡§æ‡§¨‡•Ä ‡§∏‡§Æ‡•ç‡§¨‡§®‡•ç‡§ß‡§ø ‡§∏‡•Ç‡§ö‡§®‡§æ ‡§™‡•ç‡§∞‡§ï‡§æ‡§∂‡§® ‡§≠‡§è‡§ï‡•ã ‡•§</textarea></div>
        <div class="form-group"><label>‡•ß‡•Ø. ‡§Ö‡§®‡•ç‡§Ø ‡§µ‡§ø‡§µ‡§∞‡§£:</label><textarea rows="2" id="q19" oninput="updatePreview()">‡§®‡§≠‡§è‡§ï‡•ã</textarea></div>
        <div class="form-group"><label>‡•®‡•ß. ‡§ï‡§æ‡§∞‡•ç‡§Ø‡§æ‡§≤‡§Ø‡§ï‡•ã ‡§∞‡§æ‡§Ø:</label><textarea rows="3" id="q21" oninput="updatePreview()">‡§®‡§ø‡§µ‡•á‡§¶‡§ï‡§≤‡•á ‡§¶‡§∞‡•ç‡§§‡§æ‡§ï‡§æ ‡§≤‡§æ‡§ó‡§ø ‡§ö‡§æ‡§π‡§ø‡§®‡•á ‡§Ü‡§µ‡§∂‡•ç‡§Ø‡§ï ‡§™‡•ç‡§∞‡§Æ‡§æ‡§£ ‡§∏‡§æ‡§• ‡§π‡§ï‡§¶‡§æ‡§∞ ‡§∞ ‡§π‡§ï‡§≠‡•ã‡§ó ‡§ñ‡•Å‡§≤‡•Ä ‡§Ü‡§è‡§ï‡•ã ‡§∏‡•ç‡§•‡§æ‡§®‡•Ä‡§Ø ‡§®‡§ø‡§ï‡§æ‡§Ø‡§ï‡•ã ‡§∏‡§ø‡§´‡§æ‡§∞‡§ø‡§∏ ‡§∏‡§æ‡§• ‡§Æ‡§æ‡§ó‡§¶‡§æ‡§¨‡•Ä ‡§≤‡§ø‡§è‡§ï‡•ã ‡§ú‡§ó‡•ç‡§ó‡§æ ‡§®‡§ø‡§µ‡•á‡§¶‡§ï‡§ï‡§æ ‡§®‡§æ‡§â‡§Å‡§Æ‡§æ ‡§¶‡§∞‡•ç‡§§‡§æ ‡§π‡•Å‡§®‡•á ‡§¶‡•á‡§ñ‡§ø ‡§™‡•á‡§∂ ‡§≠‡§è‡§ï‡•ã ‡•§</textarea></div>

        <br>
        <button class="btn btn-print" onclick="window.print()">üñ® Print / Save PDF</button>
        <button class="btn btn-word" onclick="exportToWord()">‚¨á Download Word (.doc)</button>
        <br><br>
        <!-- Add this button where you want a "New Form" trigger -->
<button class="btn btn-red" onclick="resetForm()" style="width:100%; margin-bottom:10px;">‚Üª New Form / Reset</button>
    </div>

    <!-- RIGHT SIDE: PREVIEW -->
    <div class="preview-pane">
        <div id="print-preview">
            <!-- JS Content -->
        </div>
    </div>
</div>

<script>
    // --- INITIALIZATION ---
    window.onload = function() {
        addHeirRow(true); 
        addNewGavisa();
        updatePreview();
    };

    // --- DATALIST LOGIC ---
    function updateDatalist() {
        const appName = getValue('app_name');
        const oldName = getValue('old_owner_name');
        const datalist = document.getElementById('person_list');
        datalist.innerHTML = ''; 
        if (appName) { let opt = document.createElement('option'); opt.value = appName; datalist.appendChild(opt); }
        if (oldName) { let opt = document.createElement('option'); opt.value = oldName; datalist.appendChild(opt); }
    }

    // --- HELPER FUNCTIONS ---
    function getValue(id) { const el = document.getElementById(id); return el ? el.value : ''; }
    function checkSubject() {
        const val = document.getElementById('subject_opt').value;
        const custom = document.getElementById('subject_custom');
        val === 'custom' ? custom.classList.remove('hidden') : custom.classList.add('hidden');
    }

    // --- HEIR TABLE ---
    function addHeirRow(isFirst = false) {
        const tbody = document.querySelector('#heir_table tbody');
        const tr = document.createElement('tr');
        const remarkVal = isFirst ? '‡§´‡§ø‡§≤‡•ç‡§°‡§¨‡•Å‡§ï‡§ï‡•ã ‡§ú.‡§ß.' : '';
        const nameInput = `<input type="text" class="h-name" list="person_list" oninput="updatePreview()">`;

        tr.innerHTML = `
            <td><input type="text" class="h-rel" oninput="updatePreview()"></td>
            <td>${nameInput}</td>
            <td><input type="text" class="h-rem" value="${remarkVal}" oninput="updatePreview()"></td>
            <td style="text-align:center;"><button class="btn btn-red" style="margin:0;" onclick="removeRow(this)">X</button></td>
        `;
        tbody.appendChild(tr);
        if(!isFirst) {
            tr.querySelector('.h-rel').focus(); // Focus on Naata
            updatePreview();
        }
    }

    // --- LAND TABLE & KITTA SELECTORS ---
    function addLandRowHTML(vdcVal, wardVal) {
        const tbody = document.querySelector('#land_table tbody');
        const tr = document.createElement('tr');
        tr.innerHTML = `
            <td><input type="text" class="l-vdc" value="${vdcVal}" oninput="updateKittaSelectors(); updatePreview()"></td>
            <td><input type="text" class="l-ward" value="${wardVal}" oninput="updatePreview()"></td>
            <td><input type="text" class="l-kit" oninput="updateKittaSelectors(); updatePreview()"></td>
            <td><input type="text" class="l-area" oninput="updatePreview()"></td>
            <td><input type="text" class="l-khalo" oninput="updatePreview()"></td>
            <td><input type="text" class="l-virah" oninput="updatePreview()"></td>
            <td><input type="text" class="l-kisim" oninput="updatePreview()"></td>
            <td><input type="text" class="l-prakriti" value="‡§∞‡•à‡§ï‡§∞" oninput="updatePreview()"></td>
            <td style="text-align:center;"><button class="btn btn-red" style="margin:0;" onclick="removeRow(this)">X</button></td>
        `;
        tbody.appendChild(tr);
        return tr;
    }

    function addSameGavisa() {
        const rows = document.querySelectorAll('#land_table tbody tr');
        let lastVdc = '', lastWard = '';
        if(rows.length > 0) {
            const lastRow = rows[rows.length - 1];
            lastVdc = lastRow.querySelector('.l-vdc').value;
            lastWard = lastRow.querySelector('.l-ward').value;
        }
        const newRow = addLandRowHTML(lastVdc, lastWard);
        updateKittaSelectors();
        updatePreview();
        newRow.querySelector('.l-kit').focus();
    }

    function addNewGavisa() {
        const newRow = addLandRowHTML('', '');
        updateKittaSelectors();
        updatePreview();
        newRow.querySelector('.l-vdc').focus();
    }

    function removeRow(btn) {
        btn.closest('tr').remove();
        updateKittaSelectors();
        updatePreview();
    }

    // --- MOHI & JHAGADA LOGIC ---
    function toggleMohi() {
        const val = document.querySelector('input[name="mohi_opt"]:checked').value;
        const section = document.getElementById('mohi_section');
        section.classList.toggle('hidden', val === 'chhaina');
        updatePreview();
    }
    
    function toggleJhagada() {
        const val = document.querySelector('input[name="jhagada_opt"]:checked').value;
        const section = document.getElementById('jhagada_section');
        section.classList.toggle('hidden', val === 'chhaina');
        updatePreview();
    }

    function updateKittaSelectors() {
        // Collect all kittas
        const kittas = [];
        document.querySelectorAll('.l-kit').forEach(input => {
            if(input.value.trim() !== '') kittas.push(input.value);
        });

        renderCheckboxes('mohi_kitta_container', kittas, 'mohi_chk');
        renderCheckboxes('jhagada_kitta_container', kittas, 'jhagada_chk');
    }

    function renderCheckboxes(containerId, kittas, prefix) {
        const container = document.getElementById(containerId);
        // Save current checked state
        const checkedValues = new Set();
        container.querySelectorAll('input[type="checkbox"]:checked').forEach(cb => checkedValues.add(cb.value));
        
        container.innerHTML = '';
        if(kittas.length === 0) {
            container.innerHTML = '<i>‡§Æ‡§æ‡§•‡§ø ‡§ï‡§ø‡§§‡•ç‡§§‡§æ ‡§®‡§Ç. ‡§≠‡§∞‡•ç‡§®‡•Å‡§π‡•ã‡§∏‡•ç</i>';
            return;
        }

        kittas.forEach(k => {
            const span = document.createElement('span');
            span.className = 'kitta-item';
            const isChecked = checkedValues.has(k) ? 'checked' : '';
            span.innerHTML = `<input type="checkbox" id="${prefix}_${k}" value="${k}" ${isChecked} onchange="updatePreview()"> ${k}`;
            container.appendChild(span);
        });
    }

    // --- TABLE MERGING ---
    function calculateSpans(data) {
        if (data.length === 0) return [];
        let spans = data.map(() => ({ vdc: 0, ward: 0 }));
        
        // VDC Merge
        let p = 0;
        while(p < data.length) {
            let count = 1;
            let val = data[p].vdc;
            for(let next = p+1; next < data.length; next++) {
                if(data[next].vdc === val) count++; else break;
            }
            spans[p].vdc = count;
            p += count;
        }
        // Ward Merge (Same VDC & Ward)
        p = 0;
        while(p < data.length) {
            let count = 1;
            let valVdc = data[p].vdc;
            let valWard = data[p].ward;
            for(let next = p+1; next < data.length; next++) {
                if(data[next].vdc === valVdc && data[next].ward === valWard) count++; else break;
            }
            spans[p].ward = count;
            p += count;
        }
        return spans;
    }

    // --- GENERATE PREVIEW ---
    function updatePreview() {
        const typeVal = document.querySelector('input[name="req_type"]:checked').value;
        const isNamsari = (typeVal === '‡§®‡§æ‡§Æ‡§∏‡§æ‡§∞‡•Ä ‡§¶‡§∞‡•ç‡§§‡§æ');
        const typeText = typeVal; // "‡§¶‡§∞‡•ç‡§§‡§æ" or "‡§®‡§æ‡§Æ‡§∏‡§æ‡§∞‡•Ä ‡§¶‡§∞‡•ç‡§§‡§æ"

        const date = getValue('date');
        const regNo = getValue('reg_no');
        let subject = getValue('subject_opt');
        if (subject === 'custom') subject = getValue('subject_custom');

        const appName = getValue('app_name');
        const appAddr = getValue('app_addr');
        const appCit = getValue('app_citizenship');
        const appDist = getValue('app_district');
        const appDate = getValue('app_c_date');
        
        const rel1 = document.getElementById('rel_type_1').value;
        const name1 = getValue('app_father');
        const rel2 = document.getElementById('rel_type_2').value;
        const name2 = getValue('app_grandfather');

        const oldOwnerName = getValue('old_owner_name');
        const oldOwnerAddr = getValue('old_owner_addr');
        const displayOldOwner = oldOwnerAddr ? `${oldOwnerAddr} ‡§¨‡§∏‡•ç‡§®‡•á ${oldOwnerName}` : (oldOwnerName || '');
        
        // Heir Table
        let heirTableRows = '';
        document.querySelectorAll('.h-rel').forEach((rel, index) => {
            const hName = document.querySelectorAll('.h-name')[index].value;
            const hRem = document.querySelectorAll('.h-rem')[index].value;
            if(hName || rel.value) {
                const combinedName = hRem ? `${hName} - ${hRem}` : hName;
                heirTableRows += `<tr><td>${rel.value}</td><td>${combinedName}</td></tr>`;
            }
        });

        // Land Data & Mohi/Jhagada Check
        const lVdcs = document.querySelectorAll('.l-vdc');
        const lWards = document.querySelectorAll('.l-ward');
        const lKits = document.querySelectorAll('.l-kit');
        const lAreas = document.querySelectorAll('.l-area');
        const lKhalos = document.querySelectorAll('.l-khalo');
        const lVirahs = document.querySelectorAll('.l-virah');
        const lKisims = document.querySelectorAll('.l-kisim');
        const lPrakritis = document.querySelectorAll('.l-prakriti');

        const isMohiEnabled = document.querySelector('input[name="mohi_opt"]:checked').value === 'chha';
        const mohiTextInput = getValue('mohi_name');
        const isJhagadaEnabled = document.querySelector('input[name="jhagada_opt"]:checked').value === 'chha';

        let landData = [];
        let summaryVDC = new Set();
        let summaryWard = new Set();
        let summaryKit = [];

        for(let i=0; i<lVdcs.length; i++){
            const kit = lKits[i].value;
            // Determine Mohi Text for this specific row
            let rowMohi = '‡§õ‡•à‡§®';
            if(isMohiEnabled && kit) {
                const isChecked = document.getElementById(`mohi_chk_${kit}`)?.checked;
                if(isChecked) rowMohi = mohiTextInput;
            }

            // Determine Jhagada Text
            let rowJhagada = '‡§õ‡•à‡§®';
            if(isJhagadaEnabled && kit) {
                const isChecked = document.getElementById(`jhagada_chk_${kit}`)?.checked;
                if(isChecked) rowJhagada = '‡§õ';
            }

            landData.push({
                vdc: lVdcs[i].value, ward: lWards[i].value, kit: kit,
                area: lAreas[i].value, khalo: lKhalos[i].value,
                virah: lVirahs[i].value, kisim: lKisims[i].value,
                prakriti: lPrakritis[i].value,
                mohi: rowMohi, jhagada: rowJhagada
            });

            if(lVdcs[i].value) summaryVDC.add(lVdcs[i].value);
            if(lWards[i].value) summaryWard.add(lWards[i].value);
            if(kit) summaryKit.push(kit);
        }

        const spans = calculateSpans(landData);
        let sec3Rows = '', sec9aRows = '', sec9bRows = '';
        const fieldbookOwner = isNamsari ? oldOwnerName : appName;
        const landRec = getValue('land_rec_no');

        landData.forEach((row, i) => {
            const sp = spans[i];
            
            // Section 3
            sec3Rows += '<tr>';
            if (sp.vdc > 0) {
                sec3Rows += `<td rowspan="${sp.vdc}">${row.vdc}</td>`;
                if (i === 0) sec3Rows += `<td rowspan="${landData.length}">${landRec}</td>`;
            }
            sec3Rows += `<td>${row.khalo}</td><td>${row.prakriti}</td>`;
            if (sp.vdc > 0) sec3Rows += `<td rowspan="${sp.vdc}">${row.vdc}</td>`;
            if (sp.ward > 0) sec3Rows += `<td rowspan="${sp.ward}">${row.ward}</td>`;
            sec3Rows += `<td>${row.kit}</td><td>${row.area}</td><td>${row.virah} ${row.kisim}</td></tr>`;

            // Section 9A
            sec9aRows += '<tr>';
            if (sp.vdc > 0) sec9aRows += `<td rowspan="${sp.vdc}">${row.vdc}</td>`;
            sec9aRows += `<td>${row.ward} / ${row.kit}</td><td>${fieldbookOwner}</td>`;
            sec9aRows += `<td>${row.mohi}</td><td>${getValue('moth_desc')}</td>`;
            sec9aRows += `<td>‡§â‡§≤‡•ç‡§≤‡•á‡§ñ ‡§õ‡•à‡§®</td><td>${row.jhagada}</td><td>${row.virah} ${row.kisim}</td></tr>`;

            // Section 9B
            sec9bRows += '<tr>';
            if (sp.vdc > 0) sec9bRows += `<td rowspan="${sp.vdc}">${row.vdc}</td>`;
            sec9bRows += `<td>${row.ward} / ${row.kit}</td><td>${getValue('moth_desc')}</td>`;
            sec9bRows += `<td>${getValue('rocca_desc')}</td><td>${getValue('sabik_desc')}</td>`;
            sec9bRows += `<td>${getValue('q7') === '‡§õ‡•à‡§®' ? '‡§¶‡•á‡§ñ‡§ø‡§®‡•ç‡§®' : '‡§¶‡•á‡§ñ‡§ø‡§®‡•ç‡§õ'}</td><td></td></tr>`;
        });

        // Text Replacements
        const replacer = (text) => text.replace(/‡§¶‡§∞‡•ç‡§§‡§æ|‡§¶‡§∞‡•ç‡§§‡§æ ‡§®‡§æ‡§Æ‡§∏‡§æ‡§∞‡•Ä/g, typeText);
        const q10Text = replacer(getValue('q10'));
        const q21Text = replacer(getValue('q21'));

        const vdcStr = Array.from(summaryVDC).join(', ');
        const wardStr = Array.from(summaryWard).join(', ');
        const kitStr = summaryKit.join(', ');

        // HTML
        const html = `
            <div style="font-weight: bold; text-align: center; margin-bottom: 20px; font-size: 16px;">
                ‡§ú‡§ó‡•ç‡§ó‡§æ‡§¶‡§∞‡•ç‡§§‡§æ‡§ï‡•ã ‡§≤‡§æ‡§ó‡§ø ‡§∏‡§ø‡§´‡§æ‡§∞‡§ø‡§∏ ‡§ó‡§∞‡•ç‡§¶‡§æ ‡§≠‡§∞‡•ç‡§®‡•Å ‡§™‡§∞‡•ç‡§®‡•á ‡§´‡§æ‡§∞‡§Æ
            </div>

            <div class="bold-text" style="margin-bottom: 10px;">‡§Æ‡§æ‡§≤‡§™‡•ã‡§§ ‡§®‡§ø‡§Ø‡§Æ‡§æ‡§µ‡§≤‡•Ä ‡•®‡•¶‡•©‡•¨ ‡§ï‡•ã ‡§®‡§ø‡§Ø‡§Æ ‡•™‡§ñ ‡§¨‡§Æ‡•ã‡§ú‡§ø‡§Æ‡§ï‡•ã ‡§ú‡§ó‡•ç‡§ó‡§æ‡§¶‡§∞‡•ç‡§§‡§æ ‡§∏‡§Æ‡§ø‡§§‡§ø‡§ï‡•ã ‡§¨‡•à‡§†‡§ï‡§ï‡•ã ‡§®‡§ø‡§∞‡•ç‡§£‡§Ø</div>
            <div class="bold-text" style="margin-bottom: 10px;">‡§®‡§ø‡§µ‡•á‡§¶‡§®‡§ï‡•ã ‡§Æ‡§ø‡§§‡§ø ‡§∞ ‡§¶‡§∞‡•ç‡§§‡§æ ‡§®‡§Æ‡•ç‡§¨‡§∞‡§É ${date} , ${regNo}</div>
            <div class="bold-text" style="margin-bottom: 10px;">‡§®‡§ø‡§µ‡•á‡§¶‡§®‡§ï‡•ã ‡§µ‡§ø‡§µ‡§∞‡§£‡§É ${subject}</div>

            <div class="bold-text" style="margin-bottom: 5px;">‡•ß. ‡§®‡§ø‡§µ‡•á‡§¶‡§ï‡§ï‡•ã ‡§µ‡§ø‡§µ‡§∞‡§£‡§É-</div>
            <div style="margin-left: 15px; margin-bottom: 10px;">
                ‡§ï. ‡§®‡§æ‡§Æ ‡§•‡§∞ ‡§µ‡§§‡§®‡§É- ${appAddr ? appAddr + ' ‡§¨‡§∏‡•ç‡§®‡•á ' : ''}${appName}<br>
                ‡§ñ. ‡§®‡§æ.‡§™‡•ç‡§∞.‡§®‡§Ç.: ${appCit}‡•§ ${appDist}, ${appDate}<br>
                ‡§ó. ${rel1} ‡§®‡§æ‡§Æ‡§É- ${name1}<br>
                ‡§ò. ${rel2} ‡§®‡§æ‡§Æ‡§É- ${name2}
            </div>

            <div class="bold-text" style="margin-bottom: 5px;">‡•®. ‡§π‡§ï‡§¶‡§æ‡§∞‡§≤‡•á ‡§¶‡§∞‡•ç‡§§‡§æ ‡§®‡§æ‡§Æ‡§∏‡§æ‡§∞‡•Ä ‡§Æ‡§æ‡§ó ‡§ó‡§∞‡•á‡§ï‡•ã‡§Æ‡§æ‡§É</div>
            <div style="margin-left: 15px; margin-bottom: 10px;">
                ‡§ï. ‡§∏‡§æ‡§µ‡§ø‡§ï ‡§¶‡§∞‡•ç‡§§‡§æ‡§µ‡§æ‡§≤‡§æ‡§ï‡•ã ‡§®‡§æ‡§Æ ‡§•‡§∞ ‡§µ‡§§‡§®‡§É-  ${displayOldOwner}<br>
                ‡§ñ. ‡§π‡§ï‡§¶‡§æ‡§∞ ‡§™‡•ç‡§∞‡§Æ‡§æ‡§£‡§É- ${getValue('heir_proof')}<br>
                ‡§ó. ‡§™‡•ç‡§∞‡§Æ‡§æ‡§£‡§¨‡§æ‡§ü ‡§¶‡•á‡§ñ‡§ø‡§è‡§ï‡•ã ‡§π‡§ï‡§¶‡§æ‡§∞‡§ï‡•ã ‡§µ‡§ø‡§µ‡§∞‡§£‡§É <br>
                <table class="result-table" style="width:70%; margin-top:5px;">
                    <tr><th width="30%">‡§®‡§æ‡§§‡§æ</th><th>‡§®‡§æ‡§Æ‡§•‡§∞</th></tr>
                    ${heirTableRows}
                </table>
                ‡§ò. ‡§ß‡•à‡§∞‡•à ‡§π‡§ï‡§¶‡§æ‡§∞ ‡§≠‡§à ‡§ï‡•á‡§π‡•Ä‡§ï‡§æ ‡§®‡§æ‡§Æ‡§Æ‡§æ ‡§¶‡§∞‡•ç‡§§‡§æ ‡§ó‡§∞‡•ç‡§® ‡§Æ‡§æ‡§ó ‡§≠‡§è‡§ï‡•ã‡§Æ‡§æ ‡§ï‡§ï‡§∏‡•ç‡§ï‡•ã ‡§®‡§æ‡§Æ‡§Æ‡§æ ‡§¶‡§∞‡•ç‡§§‡§æ ‡§π‡•Å‡§®‡•Å‡§™‡§∞‡•ç‡§®‡•á ‡§π‡•ã ‡§∏‡•ã ‡§∞ ‡§Ö‡§∞‡•Ç ‡§π‡§ï‡§¶‡§æ‡§∞‡§ï‡•ã ‡§Æ‡§®‡•ç‡§ú‡•Å‡§∞‡•Ä ‡§õ ‡§õ‡•à‡§® ? ‡§≠‡§è‡§ï‡•ã ‡§≠‡§è ‡§ï-‡§ï‡§∏‡•ç‡§ï‡•ã ‡§ñ‡•Å‡§≤‡§æ‡§â‡§®‡•á‡§É-<br>
                - ${getValue('heir_consent')}
            </div>

            <div class="bold-text" style="margin-bottom: 5px;">‡•©. ‡§¶‡§∞‡•ç‡§§‡§æ ‡§Æ‡§æ‡§ó ‡§≠‡§è‡§ï‡•ã ‡§ú‡§ó‡•ç‡§ó‡§æ‡§ï‡•ã ‡§®‡§æ‡§™‡•Ä ‡§Ö‡§®‡•Å‡§∏‡§æ‡§∞‡§ï‡•ã ‡§µ‡§ø‡§µ‡§∞‡§£‡§É-</div>
            <table class="result-table">
                <thead>
                    <tr>
                        <th rowspan="2">‡§Æ‡•å‡§ú‡§æ</th><th rowspan="2">‡§∞.‡§®‡§Ç. ‡§π‡§æ.‡§®‡§Ç. ‡§∞ ‡§™‡•ã‡§§‡§æ ‡§®‡§Ç.</th><th rowspan="2">‡§ñ‡§≤‡•ã</th><th rowspan="2">‡§∞‡§æ‡§ú ‡§ó‡•Å‡§†‡•Ä, ‡§®‡§ø‡§ú‡•Ä ‡§ó‡•Å‡§†‡•Ä ‡§µ‡§ø‡§∞‡•ç‡§§‡§æ ‡§ï‡•á ‡§π‡•ã?</th>
                        <th colspan="5" style="text-align:center">‡§ú‡§ó‡•ç‡§ó‡§æ‡§ï‡•ã ‡§µ‡§ø‡§µ‡§∞‡§£</th>
                    </tr>
                    <tr><th>‡§™‡§û‡•ç‡§ö‡§æ‡§Ø‡§§</th><th>‡§µ‡§°‡§æ ‡§®‡§Ç.</th><th>‡§ï‡§ø.‡§®‡§Ç.</th><th>‡§ï‡•ç‡§∑‡•á.‡§´.</th><th>‡§µ‡§ø‡§∞‡§π</th></tr>
                </thead>
                <tbody>${sec3Rows}</tbody>
            </table>

            <div class="bold-text" style="margin-bottom: 8px;">‡•™. ‡•≠ ‡§®‡§Ç. ‡§´‡§æ‡§Å‡§ü‡§µ‡§æ‡§∞‡•Ä‡§Æ‡§æ ‡§â‡§ï‡•ç‡§§ ‡§∏‡§æ‡§µ‡§ø‡§ï‡§ï‡•ã ‡§µ‡§ø‡§µ‡§∞‡§£ ‡§≠‡§ø‡§°‡•ç‡§õ ‡§≠‡§ø‡§°‡•ç‡§¶‡•à‡§® ?</div>
            <div style="margin-left: 20px; margin-bottom:8px;">- ${getValue('q4')}</div>

            <div class="bold-text" style="margin-bottom: 8px;">‡•´. ‡§â‡§ï‡•ç‡§§ ‡§ú‡§ó‡•ç‡§ó‡§æ ‡§¶‡§∞‡•ç‡§§‡§æ‡§ï‡•ã ‡§≤‡§æ‡§ó‡§ø ‡§ï‡•á ‡§ï‡§∏‡•ç‡§§‡•ã ‡§™‡•ç‡§∞‡§Æ‡§æ‡§£ ‡§™‡•á‡§∂ ‡§≠‡§è‡§ï‡•ã ‡§õ?</div>
            <div style="margin-left: 20px; margin-bottom:8px;">- ‡§´‡§ø‡§≤‡•ç‡§°‡§¨‡•Å‡§ï, ‡§∏‡§æ‡§¨‡§ø‡§ï ‡§≤‡§ó‡§§, ‡§∏‡§æ‡§¨‡§ø‡§ï ‡§§‡§ø‡§∞‡•ã‡§ï‡•ã ‡§∞‡§∏‡§ø‡§¶, ‡•ß ‡§∞ ‡•®‡§®‡§Ç. ‡§Ö‡§®‡•Å‡§∏‡•Ç‡§ö‡§ø ${getValue('q5_extra') ? ', ' + getValue('q5_extra') : ''} ‡§∏‡§Æ‡•á‡§§ ‡•§</div>

            <div class="bold-text" style="margin-bottom: 8px;">‡•¨. ‡§∏‡§æ‡§µ‡§ø‡§ï ‡§≤‡§ó‡§§‡§ï‡•ã ‡§ú‡§ó‡•ç‡§ó‡§æ ‡§Æ‡§ß‡•ç‡§Ø‡•á ‡§ï‡§§‡§ø ‡§¶‡§∞‡•ç‡§§‡§æ ‡§≠‡§Ø‡•ã ‡§∞ ‡§ï‡§§‡§ø ‡§¶‡§∞‡•ç‡§§‡§æ ‡§π‡•Å‡§® ‡§¨‡§æ‡§Å‡§ï‡•Ä ‡§õ ‡§≠‡§®‡•Ä ‡§®‡§ø‡§µ‡•á‡§¶‡§ï‡§≤‡•á ‡§ñ‡•Å‡§≤‡§æ‡§è‡§ï‡•ã ‡§õ ?</div>
            <div style="margin-left: 20px; margin-bottom:8px;">- ${getValue('q6')}</div>

            <div class="bold-text" style="margin-bottom: 8px;">‡•≠. ‡§™‡§π‡§ø‡§≤‡•á ‡§®‡§ø‡§µ‡•á‡§¶‡§® ‡§¶‡§ø‡§è‡§ï‡•ã ‡§≠‡§è ‡§≠‡§è‡§ï‡•ã ‡§ï‡§æ‡§∞‡§µ‡§æ‡§π‡•Ä‡§ï‡•ã ‡§µ‡•ç‡§Ø‡§π‡•ã‡§∞‡§æ ?</div>
            <div style="margin-left: 20px; margin-bottom:8px;">- ${getValue('q7')}</div>

            <div class="bold-text" style="margin-bottom: 8px;">‡•Æ. ‡§¶‡§∞‡•ç‡§§‡§æ ‡§Æ‡§æ‡§ó ‡§≠‡§è‡§ï‡•ã ‡§ú‡§ó‡•ç‡§ó‡§æ‡§ï‡•ã ‡§ï‡•Å‡§® ‡§∏‡§æ‡§≤ ‡§∏‡§Æ‡•ç‡§Æ‡§ï‡•ã ‡§Æ‡§æ‡§≤‡§™‡•ã‡§§ ‡§¨‡•Å‡§ù‡§æ‡§è‡§ï‡•ã ‡§õ ‡§∞ ‡§ï‡•Å‡§® ‡§∏‡§æ‡§≤ ‡§¶‡•á‡§ñ‡§ø‡§ï‡•ã ‡§Æ‡§æ‡§≤‡§™‡•ã‡§§ ‡§¨‡•Å‡§ù‡§æ‡§â‡§® ‡§¨‡§æ‡§Å‡§ï‡•Ä ‡§õ ‡§≠‡§®‡•Ä ‡§®‡§ø‡§µ‡•á‡§¶‡§ï‡§≤‡•á ‡§ñ‡•Å‡§≤‡§æ‡§è‡§ï‡•ã ‡§õ ? ‡§ß‡§∞‡•å‡§ü‡•Ä ‡§∞‡§π‡•á‡§ï‡•ã ‡§≠‡§è ‡§ï‡•Å‡§® ‡§∏‡§æ‡§≤ ‡§∏‡§Æ‡•ç‡§Æ‡§ï‡•ã ‡§ß‡§∞‡•å‡§ü‡•Ä ‡§ï‡§π‡§æ‡§Å ‡§∞‡§π‡•á‡§ï‡•ã ‡§™‡•ç‡§∞‡§Æ‡§æ‡§£ ‡§ï‡•á ‡§™‡•á‡§∂ ‡§õ ?</div>
            <div style="margin-left: 20px; margin-bottom:8px;">- ${getValue('q8')}</div>

            <div class="bold-text" style="margin-bottom: 5px;">‡•Ø. ‡§ï‡§æ‡§∞‡•ç‡§Ø‡§æ‡§≤‡§Ø‡§ï‡•ã ‡§∂‡•ç‡§∞‡•á‡§∑‡•ç‡§§‡§æ ‡§≠‡§ø‡§°‡§æ‡§è‡§ï‡•ã ‡§µ‡§ø‡§µ‡§∞‡§£‡§É-</div>
            <div style="margin-left: 10px;"><b>‡§ï. ‡§´‡§ø‡§≤‡•ç‡§°‡§¨‡•Å‡§ï‡§¨‡§æ‡§ü ‡§¶‡•á‡§ñ‡§ø‡§è‡§ï‡•ã‡§É-</b></div>
            <table class="result-table">
                <thead>
                    <tr>
                        <th>‡§™‡§û‡•ç‡§ö‡§æ‡§Ø‡§§</th><th>‡§µ‡§°‡§æ ‡§®‡§Ç./‡§ï‡§ø.‡§®‡§Ç.</th><th>‡§ú‡§ó‡•ç‡§ó‡§æ‡§ß‡§®‡•Ä‡§ï‡•ã ‡§®‡§æ‡§Æ ‡§•‡§∞</th><th>‡§Æ‡•ã‡§π‡•Ä‡§ï‡•ã ‡§®‡§æ‡§Æ, ‡§•‡§∞</th>
                        <th>‡§ï‡•à‡§´‡§ø‡§Ø‡§§ ‡§µ‡•ç‡§Ø‡§π‡•ã‡§∞‡§æ</th><th>‡§´‡§ø‡§≤‡•ç‡§°‡§¨‡•Å‡§ï ‡§™‡•ç‡§∞‡§Æ‡§æ‡§£‡§ø‡§§ ‡§ó‡§∞‡•ç‡§®‡•á</th><th>‡§ù‡§ó‡§°‡§æ ‡§ú‡§®‡§æ‡§è‡§ï‡•ã ‡§õ ‡§õ‡•à‡§®</th><th>‡§µ‡§ø‡§∞‡§π/‡§ï‡§ø‡§∏‡§ø‡§Æ</th>
                    </tr>
                </thead>
                <tbody>${sec9aRows}</tbody>
            </table>

            <div style="margin-left: 10px;"><b>‡§ñ. ‡§Ö‡§®‡•ç‡§Ø ‡§∂‡•ç‡§∞‡•á‡§∑‡•ç‡§§‡§æ ‡§≠‡§ø‡§°‡§æ‡§è‡§ï‡•ã‡§É-</b></div>
            <table class="result-table">
                <thead>
                    <tr>
                        <th>‡§™‡§û‡•ç‡§ö‡§æ‡§Ø‡§§</th><th>‡§µ‡§°‡§æ ‡§®‡§Ç./‡§ï‡§ø.‡§®‡§Ç.</th><th>‡§Æ‡•ã‡§† ‡§∂‡•ç‡§∞‡•á‡§∑‡•ç‡§§‡§æ‡§¨‡§æ‡§ü ‡§¶‡•á‡§ñ‡§ø‡§è‡§ï‡•ã ‡§µ‡§ø‡§µ‡§∞‡§£</th><th>‡§∞‡•ã‡§ï‡•ç‡§ï‡§æ ‡§õ/‡§õ‡•à‡§®?</th>
                        <th>‡§∏‡§æ‡§µ‡§ø‡§ï ‡§≤‡§ó‡§§ ‡§≠‡§ø‡§°‡•á‡§ï‡•ã ‡§õ/‡§õ‡•à‡§®</th><th>‡§Ö‡§∞‡•Ç ‡§ï‡§æ‡§∞‡§¨‡§æ‡§π‡•Ä ‡§µ‡§æ ‡§Æ‡•Å‡§¶‡•ç‡§¶‡§æ ‡§ö‡§≤‡•á‡§ï‡•ã ‡§¶‡•á‡§ñ‡§ø‡§®‡•ç‡§õ/ ‡§¶‡•á‡§ñ‡§ø‡§®‡•ç‡§®</th><th>‡§Ö‡§®‡•ç‡§Ø ‡§µ‡•ç‡§Ø‡§π‡•ã‡§∞‡§æ</th>
                    </tr>
                </thead>
                <tbody>${sec9bRows}</tbody>
            </table>

            <div class="bold-text" style="margin-left: 10px; margin-bottom:8px;">‡§ó. ‡§≤‡•Å‡§ú‡§∏‡•Ä‡§ü ‡§≠‡§ø‡§°‡•á‡§ï‡•ã ‡§õ/‡§õ‡•à‡§® ? - <span style="font-weight:normal">${getValue('loose_sheet')}</span></div>

            <div class="bold-text" style="margin-bottom: 5px;">‡•ß‡•¶. ‡§∏‡§Æ‡•ç‡§¨‡§®‡•ç‡§ß‡§ø‡§§ ‡§∏‡•ç‡§•‡§æ‡§®‡•Ä‡§Ø ‡§§‡§π‡§ï‡•ã ‡§∏‡§ø‡§´‡§æ‡§∞‡§ø‡§∏‡§ï‡•ã ‡§µ‡•ç‡§Ø‡§π‡•ã‡§∞‡§æ</div>
            <div style="margin-left: 20px; margin-bottom:8px;">- ${q10Text}</div>
            <div class="bold-text" style="margin-bottom: 5px;">‡•ß‡•ß. ‡§∏‡§∞‡•ç‡§ú‡§Æ‡§ø‡§®‡§ï‡•ã ‡§≠‡§®‡§æ‡§á‡§É</div>
            <div style="margin-left: 20px; margin-bottom:8px;">- ${getValue('q11')}</div>
            <div class="bold-text" style="margin-bottom: 5px;">‡•ß‡•®. ‡§∏‡•ç‡§•‡§≤‡§ó‡§§ ‡§®‡•Ä‡§∞‡§ø‡§ï‡•ç‡§∑‡§£ ‡§ó‡§∞‡§ø‡§è‡§ï‡•ã‡§Æ‡§æ ‡§∏‡•ç‡§•‡§≤‡§ó‡§§ ‡§®‡•Ä‡§∞‡§ø‡§ï‡•ç‡§∑‡§£‡§¨‡§æ‡§ü ‡§¶‡•á‡§ñ‡§ø‡§è‡§ï‡•ã ‡§ú‡§ó‡•ç‡§ó‡§æ‡§ï‡•ã ‡§∏‡•ç‡§•‡§ø‡§§‡§ø‡§É-</div>
            <div style="margin-left: 20px; margin-bottom:8px;">- ${getValue('q12')}</div>
            <div class="bold-text" style="margin-bottom: 5px;">‡•ß‡•©. ‡§´‡§ø‡§≤‡•ç‡§°‡§¨‡•Å‡§ï‡§Æ‡§æ ‡§¶‡•á‡§ñ‡§ø‡§è‡§ï‡•ã ‡§ú‡§ó‡•ç‡§ó‡§æ‡§ß‡§®‡•Ä ‡§¨‡•Å‡§ù‡§ø‡§è‡§ï‡•ã ‡§≠‡§è ‡§≠‡§∞‡§™‡§æ‡§à</div>
            <div style="margin-left: 20px; margin-bottom:8px;">- ‡§õ‡•à‡§®</div>
            <div class="bold-text" style="margin-bottom: 5px;">‡•ß‡•™. ‡§´‡§ø‡§≤‡•ç‡§°‡§¨‡•Å‡§ï‡§Æ‡§æ ‡§¶‡•á‡§ñ‡§ø‡§è‡§ï‡•ã ‡§Æ‡•ã‡§π‡•Ä ‡§¨‡•Å‡§ù‡§ø‡§è‡§ï‡•ã ‡§≠‡§è ‡§Æ‡•ã‡§π‡•Ä‡§ï‡•ã ‡§≠‡§®‡§æ‡§á‡§É</div>
            <div style="margin-left: 20px; margin-bottom:8px;">- ‡§õ‡•à‡§®</div>
            <div class="bold-text" style="margin-bottom: 5px;">‡•ß‡•´. ‡§∏‡§æ‡§∞‡•ç‡§µ‡§ú‡§®‡§ø‡§ï ‡§∏‡•Ç‡§ö‡§®‡§æ‡§ï‡•ã ‡§∏‡§Ç‡§ï‡•ç‡§∑‡§ø‡§™‡•ç‡§§ ‡§µ‡§ø‡§µ‡§∞‡§£ ‡§∞ ‡§¶‡§æ‡§¨‡•Ä ‡§™‡§∞‡•á ‡§®‡§™‡§∞‡•á‡§ï‡•ã‡§É</div>
            <div style="margin-left: 20px; margin-bottom:8px;">- ${getValue('q15')}</div>
            <div class="bold-text" style="margin-bottom: 5px;">‡•ß‡•¨. ‡§®‡§¶‡•Ä ‡§â‡§ï‡§æ‡§∏ ‡§ú‡§ó‡•ç‡§ó‡§æ ‡§≠‡§è ‡§∏‡§Æ‡•ç‡§¨‡§®‡•ç‡§ß‡§ø‡§§ ‡§™‡•ç‡§∞‡§æ‡§µ‡§ø‡§ß‡§ø‡§ï ‡§™‡§ï‡•ç‡§∑‡§ï‡•ã ‡§Æ‡§®‡•ç‡§§‡§µ‡•ç‡§Ø ‡§ï‡•á ‡§π‡•ã ?</div>
            <div style="margin-left: 20px; margin-bottom:8px;">- ‡§π‡•ã‡§á‡§®</div>

            <div class="bold-text" style="margin-bottom: 8px;">‡•ß‡•≠. ‡§µ‡§® ‡§ï‡§æ‡§∞‡•ç‡§Ø‡§æ‡§≤‡§Ø‡§ï‡•ã ‡§∏‡•ç‡§µ‡•Ä‡§ï‡•É‡§§‡§ø ‡§≤‡§ø‡§®‡•Å‡§™‡§∞‡•ç‡§®‡•á ‡§≠‡§è ‡§∏‡•ç‡§µ‡•Ä‡§ï‡•É‡§§‡§ø ‡§¶‡§ø‡§®‡•á ‡§ï‡§æ‡§∞‡•ç‡§Ø‡§æ‡§≤‡§Ø‡§ï‡•ã ‡§®‡§æ‡§Æ........................................ ‡§™‡§§‡•ç‡§∞ ‡§∏‡§Ç‡§ñ‡•ç‡§Ø‡§æ............................... ‡§Æ‡§ø‡§§‡§ø..................</div>
            <div class="bold-text" style="margin-bottom: 8px;">‡•ß‡•Æ. ‡§ú‡§≤‡§æ‡§ß‡§æ‡§∞ ‡§∏‡§Ç‡§∞‡§ï‡•ç‡§∑‡§£ ‡§Ö‡§ß‡§ø‡§ï‡•É‡§§‡§ï‡•ã ‡§∏‡•ç‡§µ‡•Ä‡§ï‡•É‡§§‡§ø ‡§≤‡§ø‡§®‡•Å ‡§™‡§∞‡•ç‡§®‡•á ‡§≠‡§è ‡§∏‡•ç‡§µ‡•Ä‡§ï‡•É‡§§‡§ø ‡§¶‡§ø‡§®‡•á ‡§ï‡§æ‡§∞‡•ç‡§Ø‡§æ‡§≤‡§Ø‡§ï‡•ã ‡§®‡§æ‡§Æ.............................. ‡§™‡§§‡•ç‡§∞ ‡§∏‡§Ç‡§ñ‡•ç‡§Ø‡§æ....................................... ‡§Æ‡§ø‡§§‡§ø</div>
            <div class="bold-text" style="margin-bottom: 5px;">‡•ß‡•Ø. ‡§Ö‡§®‡•ç‡§Ø ‡§ï‡•á‡§π‡•Ä ‡§ñ‡•Å‡§≤‡§æ‡§â‡§®‡•Å‡§™‡§∞‡•ç‡§®‡•á ‡§µ‡§ø‡§µ‡§∞‡§£ ‡§≠‡§è ‡§ñ‡•Å‡§≤‡§æ‡§â‡§®‡•á</div>
            <div style="margin-left: 20px; margin-bottom:8px;">- ${getValue('q19')}</div>

            <div class="bold-text" style="margin-top: 15px; margin-bottom: 25px;">‡•®‡•¶. ‡§™‡•á‡§∂ ‡§≠‡§è‡§ï‡•ã ‡§Æ‡§ø‡§∏‡§ø‡§≤ ‡§∏‡§Ç‡§∞‡§ï‡•ç‡§∑‡§£ ‡§ï‡§æ‡§ó‡§ú‡§æ‡§§ ‡§∏‡§¨‡•Å‡§§ ‡§™‡•ç‡§∞‡§Æ‡§æ‡§£ ‡§§‡§•‡§æ ‡§ï‡§æ‡§∞‡•ç‡§Ø‡§æ‡§≤‡§Ø‡§ï‡•ã ‡§∂‡•ç‡§∞‡•á‡§∑‡•ç‡§§‡§æ ‡§∏‡§Æ‡•á‡§§ ‡§≠‡§ø‡§°‡•á‡§ï‡•ã ‡§â‡§™‡§Ø‡•Å‡§ï‡•ç‡§§ ‡§µ‡§ø‡§µ‡§∞‡§£ ‡§≠‡§∞‡•á‡§ï‡•ã ‡§π‡•ã ‡§≠‡§®‡•Ä ‡§∏‡§π‡•Ä ‡§ó‡§∞‡•ç‡§®‡•á ‡§ï‡§∞‡•ç‡§Æ‡§ö‡§æ‡§∞‡•Ä‡§É</div>
            <div style="width: 200px; border-bottom: 1px none black; margin-bottom: 5px;"></div>
            <div></div>

            <div class="bold-text" style="margin-bottom: 5px; margin-top: 10px;">‡•®‡•ß. ‡§ï‡§æ‡§∞‡•ç‡§Ø‡§æ‡§≤‡§Ø‡§ï‡•ã ‡§∞‡§æ‡§Ø‡§É-</div>
            <div style="margin-left: 20px; margin-bottom:8px;">${q21Text}</div>

            <div class="bold-text" style="margin-bottom: 5px;">‡•®‡•®. ‡§∏‡§Æ‡§ø‡§§‡§ø‡§ï‡•ã ‡§∏‡§ø‡§´‡§æ‡§∞‡§ø‡§∏‡§É-</div>
            <div style="text-align: justify; margin-bottom: 30px;">
            ‡§®‡§ø‡§µ‡•á‡§¶‡§ï‡§ï‡•ã ‡§Ü‡§´‡•ç‡§®‡•à ‡§®‡§æ‡§â‡§ï‡•ã ‡§´‡§ø‡§≤‡•ç‡§°‡§¨‡•Å‡§ï, ‡§∏‡§æ‡§¨‡§ø‡§ï ‡§≤‡§ó‡§§, ‡§∏‡§æ‡§¨‡§ø‡§ï ‡§§‡§ø‡§∞‡•ã‡§ï‡•ã ‡§¶‡§∞‡§™‡§ø‡§† ‡§∞‡§∏‡§ø‡§¶, ‡•ß ‡§®‡§Ç. ‡•® ‡§®‡§Ç. ‡§Ö‡§®‡•Å‡§∏‡•Ç‡§ö‡§ø‡§ï‡§æ ‡§´‡§æ‡§∞‡§Æ, ‡§ï‡§ø‡§ü‡§æ‡§®‡•Ä ‡§π‡§ï‡§¶‡§æ‡§∞ ‡§∞ ‡§π‡§ï‡§≠‡•ã‡§ó ‡§ñ‡•Å‡§≤‡•á‡§ï‡•ã ‡§∏‡•ç‡§•‡§æ‡§®‡•Ä‡§Ø ‡§®‡§ø‡§ï‡§æ‡§Ø‡§ï‡•ã ‡§∏‡§ø‡§´‡§æ‡§∞‡§ø‡§∏, ${getValue('q5_extra') ? getValue('q5_extra') + ',' : ''} ‡§π‡§ï‡§¶‡§æ‡§¨‡•Ä ‡§∏‡§Æ‡•ç‡§¨‡§®‡•ç‡§ß‡§ø ‡§™‡•ç‡§∞‡§ï‡§æ‡§∂‡§ø‡§§ ‡•©‡•´ ‡§¶‡§ø‡§®‡•á ‡§∏‡§æ‡§∞‡•ç‡§µ‡§ú‡§®‡§ø‡§ï ‡§∏‡•Ç‡§ö‡§®‡§æ, ‡§∏‡•ã‡§ï‡•ã ‡§Æ‡•ç‡§Ø‡§æ‡§¶ ‡§≠‡•Å‡§ï‡•ç‡§§‡§æ‡§® ‡§π‡•Å‡§Å‡§¶‡§æ ‡§ï‡•ã‡§π‡•Ä ‡§ï‡§∏‡•à‡§ï‡•ã ‡§™‡§®‡§ø ‡§®‡§™‡§∞‡•á‡§ï‡•ã ‡§¶‡§æ‡§¨‡•Ä ‡§µ‡§ø‡§∞‡•ã‡§ß, ‡§ï‡§æ‡§∞‡•ç‡§Ø‡§æ‡§≤‡§Ø‡§ï‡•ã ‡§§‡§∞‡•ç‡§´‡§¨‡§æ‡§ü ‡§¨‡•Å‡§ù‡§ø‡§è‡§ï‡•ã ‡§∏‡•ç‡§•‡§≤‡§ó‡§§ ‡§∏‡§∞‡•ç‡§ú‡§Æ‡§ø‡§® ‡§∏‡§ø‡§´‡§æ‡§∞‡§ø‡§∏‡§¨‡§æ‡§ü ‡§∏‡§Æ‡•á‡§§ ‡§®‡§ø‡§µ‡•á‡§¶‡§ï <b>${appName}</b> ‡§π‡§ï‡§¶‡§æ‡§∞ ‡§π‡•Å‡§® ‡§≠‡§®‡•ç‡§®‡•á ‡§ï‡•Å‡§∞‡§æ‡§Æ‡§æ ‡§Æ‡§§‡•à‡§ï‡•ç‡§Ø ‡§∞‡§π‡•á‡§ï‡•ã ‡§¶‡•á‡§ñ‡§ø‡§è‡§ï‡•ã ‡§π‡•Å‡§Å‡§¶‡§æ ‡§®‡§ø‡§ú‡§ï‡§æ ‡§®‡§æ‡§â‡§Å‡§Æ‡§æ ‡§∏‡§æ‡§¨‡§ø‡§ï <b>${vdcStr}</b> ‡§µ‡§°‡§æ ‡§®‡§Ç. <b>${wardStr}</b> ‡§ï‡§æ ‡§ï‡§ø.‡§®‡§Ç. <b>${kitStr}</b> ‡§ï‡•ã ‡§ú‡§ó‡•ç‡§ó‡§æ ${typeText} ‡§ó‡§∞‡•Ä ‡§∂‡•ç‡§∞‡•á‡§∑‡•ç‡§§‡§æ ‡§™‡•Å‡§∞‡•ç‡§ú‡§æ ‡§ï‡§æ‡§Ø‡§Æ ‡§ó‡§∞‡§ø‡§¶‡§ø‡§® ‡§Ü‡§µ‡§∂‡•ç‡§Ø‡§ï ‡§®‡§ø‡§∞‡•ç‡§£‡§Ø ‡§∏‡§π‡§ø‡§§ ‡§∏‡§ø‡§´‡§æ‡§∞‡§ø‡§∏ ‡§ó‡§∞‡§ø‡§Ø‡•ã ‡•§
            </div>

            <!-- FOOTER SIGNATURES -->
            <table style="width:100%; border:none; margin-top:30px;">
                <tr>
                    <td style="border:none; text-align:center; vertical-align:top;">
                        ...........................<br>
                        ‡§Æ‡§æ‡§≤‡§™‡•ã‡§§ ‡§ï‡§æ‡§∞‡•ç‡§Ø‡§æ‡§≤‡§Ø‡§ï‡•ã<br>
                        ‡§µ‡§∞‡§ø‡§∑‡•ç‡§† ‡§ï‡§∞‡•ç‡§Æ‡§ö‡§æ‡§∞‡•Ä<br>
                        ‡§∏‡§¶‡§∏‡•ç‡§Ø
                    </td>
                    <td style="border:none; text-align:center; vertical-align:top;">
                        ...........................<br>
                        ‡§®‡§æ‡§™‡•Ä ‡§ï‡§æ‡§∞‡•ç‡§Ø‡§æ‡§≤‡§Ø‡§ï‡•ã <br>
                        ‡§™‡•ç‡§∞‡§§‡§ø‡§®‡§ø‡§ß‡§ø<br>
                        ‡§∏‡§¶‡§∏‡•ç‡§Ø
                    </td>
                    <td style="border:none; text-align:center; vertical-align:top;">
                        ...........................<br>
                        ‡§™‡•ç‡§∞‡§Æ‡•Å‡§ñ ‡§Æ‡§æ‡§≤‡§™‡•ã‡§§ ‡§Ö‡§ß‡§ø‡§ï‡•É‡§§<br>
                        ‡§Ö‡§ß‡•ç‡§Ø‡§ï‡•ç‡§∑
                    </td>
                </tr>
            </table>
        `;

        document.getElementById('print-preview').innerHTML = html;
        window.generatedAppName = appName || '‡§®‡§ø‡§µ‡•á‡§¶‡§ï';
    }

    function exportToWord() {
        const content = document.getElementById('print-preview').innerHTML;
        const header = `
            <html xmlns:o='urn:schemas-microsoft-com:office:office' xmlns:w='urn:schemas-microsoft-com:office:word' xmlns='http://www.w3.org/TR/REC-html40'>
            <head><meta charset='utf-8'><title>Export</title>
            <style>body{font-family:'Kalimati',Arial,sans-serif}table{border-collapse:collapse;width:100%}td,th{border:1px solid #000;padding:5px;vertical-align:top}.bold-text{font-weight:bold}</style>
            </head><body>`;
        const footer = "</body></html>";
        const sourceHTML = header + content + footer;
        const source = 'data:application/vnd.ms-word;charset=utf-8,' + encodeURIComponent(sourceHTML);
        const fileDownload = document.createElement("a");
        document.body.appendChild(fileDownload);
        fileDownload.href = source;
        fileDownload.download = `‡§¶‡§∞‡•ç‡§§‡§æ_‡§∏‡§ø‡§´‡§æ‡§∞‡§ø‡§∏_${window.generatedAppName}.doc`;
        fileDownload.click();
        document.body.removeChild(fileDownload);
    }
// --- 1. AUTO-SAVE LOGIC ---
    const FORM_KEY = 'jagga_darta_autosave';

    // Listen for inputs to save
    document.querySelector('.form-pane').addEventListener('input', () => saveToLocal());
    document.querySelector('.form-pane').addEventListener('change', () => saveToLocal());

    function saveToLocal() {
        // Collect Inputs
        const inputs = {};
        document.querySelectorAll('input, textarea, select').forEach(el => {
            if(el.id) inputs[el.id] = (el.type === 'checkbox' || el.type === 'radio') ? el.checked : el.value;
            else if(el.name && el.type === 'radio' && el.checked) inputs[el.name] = el.value;
        });
        
        // Collect Tables (HTML content is easier to restore for exact replication)
        const heirRows = [];
        document.querySelectorAll('#heir_table tbody tr').forEach(tr => {
            heirRows.push({
                rel: tr.querySelector('.h-rel').value,
                name: tr.querySelector('.h-name').value,
                rem: tr.querySelector('.h-rem').value
            });
        });

        const landRows = [];
        document.querySelectorAll('#land_table tbody tr').forEach(tr => {
            landRows.push({
                vdc: tr.querySelector('.l-vdc').value,
                ward: tr.querySelector('.l-ward').value,
                kit: tr.querySelector('.l-kit').value,
                area: tr.querySelector('.l-area').value,
                khalo: tr.querySelector('.l-khalo').value,
                virah: tr.querySelector('.l-virah').value,
                kisim: tr.querySelector('.l-kisim').value,
                prakriti: tr.querySelector('.l-prakriti').value
            });
        });

        const data = { inputs, heirRows, landRows };
        localStorage.setItem(FORM_KEY, JSON.stringify(data));
    }

    // --- 2. RESTORE LOGIC ---
    function restoreFromLocal() {
        const raw = localStorage.getItem(FORM_KEY);
        if(!raw) return false;

        const data = JSON.parse(raw);

        // Restore Inputs
        for(const [key, val] of Object.entries(data.inputs)) {
            const el = document.getElementById(key);
            if(el) {
                if(el.type === 'checkbox') el.checked = val;
                else el.value = val;
            } else {
                // Radio buttons by name
                const radio = document.querySelector(`input[name="${key}"][value="${val}"]`);
                if(radio) radio.checked = true;
            }
        }

        // Restore Tables (Clear current -> Rebuild)
        document.querySelector('#heir_table tbody').innerHTML = '';
        data.heirRows.forEach(row => {
            addHeirRow();
            const tr = document.querySelector('#heir_table tbody tr:last-child');
            tr.querySelector('.h-rel').value = row.rel;
            tr.querySelector('.h-name').value = row.name;
            tr.querySelector('.h-rem').value = row.rem;
        });

        document.querySelector('#land_table tbody').innerHTML = '';
        data.landRows.forEach(row => {
            // Create row structure
            const tr = addLandRowHTML(row.vdc, row.ward);
            tr.querySelector('.l-kit').value = row.kit;
            tr.querySelector('.l-area').value = row.area;
            tr.querySelector('.l-khalo').value = row.khalo;
            tr.querySelector('.l-virah').value = row.virah;
            tr.querySelector('.l-kisim').value = row.kisim;
            tr.querySelector('.l-prakriti').value = row.prakriti;
        });

        // Trigger UI updates
        checkSubject();
        toggleMohi();
        toggleJhagada();
        updateKittaSelectors(); 
        updatePreview();
        return true;
    }

    // --- 3. RESET FORM ---
    function resetForm() {
        if(confirm("Are you sure you want to clear everything?")) {
            localStorage.removeItem(FORM_KEY);
            location.reload();
        }
    }

    // --- 4. INITIALIZATION ---
    window.onload = function() {
        const hasData = localStorage.getItem(FORM_KEY);
        
        let restored = false;
        
        // ASK THE USER
        if(hasData) {
            if(confirm("Unsaved data found! \nPress OK to Recover it.\nPress Cancel for a New Form.")) {
                restored = restoreFromLocal();
            } else {
                localStorage.removeItem(FORM_KEY); // User wants new form
            }
        }

        // If not restored, set defaults
        if(!restored) {
            addHeirRow(true);
            addNewGavisa();
            updatePreview();
        }

        // FORCE FOCUS ON DATE (Wait 100ms to override other events)
        setTimeout(() => {
            document.getElementById('date').focus();
        }, 100);
    };
    // --- ENGLISH TO NEPALI NUMBER CONVERTER ---
    const nepaliNumMap = {
        '0': '‡•¶', '1': '‡•ß', '2': '‡•®', '3': '‡•©', '4': '‡•™',
        '5': '‡•´', '6': '‡•¨', '7': '‡•≠', '8': '‡•Æ', '9': '‡•Ø'
    };

    document.querySelector('.form-pane').addEventListener('input', function(e) {
        // Target specific input types (text, number, or mostly any input in your form)
        const target = e.target;
        
        // Skip if it's a checkbox or radio
        if (target.type === 'checkbox' || target.type === 'radio') return;

        const val = target.value;
        
        // Only run if there are English numbers (0-9) present
        if (/[0-9]/.test(val)) {
            // 1. Save the cursor position (so typing doesn't jump to the end)
            const start = target.selectionStart;
            const end = target.selectionEnd;

            // 2. Replace numbers
            const newVal = val.replace(/[0-9]/g, match => nepaliNumMap[match]);
            target.value = newVal;

            // 3. Restore cursor position
            if (target.setSelectionRange) {
                target.setSelectionRange(start, end);
            }

            // 4. Force Preview Update again (to ensure the Nepali number shows up immediately)
            updatePreview(); 
            
            // 5. (Optional) Force Auto-Save update if you are using the previous auto-save code
            if(typeof saveToLocal === 'function') {
                saveToLocal();
            }
        }
    });
    if ('serviceWorker' in navigator) {
  window.addEventListener('load', () => {
    navigator.serviceWorker.register('/sw.js')
      .then(reg => console.log('SW registered:', reg.scope))
      .catch(err => console.error('SW registration failed:', err));
  });
}

</script>
</body>
</html>