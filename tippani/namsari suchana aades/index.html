<!DOCTYPE html>
<html lang="ne">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>नामसारी सुचना, आदेश-acharyasuman4</title>
    <link href="https://fonts.googleapis.com/css2?family=Mukta:wght@300;400;700&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { font-family: 'Mukta', sans-serif; background-color: #f1f5f9; }
        
        /* Screen Preview Style - Optimized to fit container */
        .preview-page { 
            background: white; 
            padding: 40px 40px 40px 60px; /* Screen friendly padding */
            min-height: 10in; 
            width: 100%; 
            max-width: 8.5in; 
            margin: 0 auto; 
            box-shadow: 0 0 20px rgba(0,0,0,0.1); 
            text-align: justify; 
            line-height: 1.7; 
            font-size: 16px;
        }

        .input-box { border: 1px solid #cbd5e1; padding: 5px; border-radius: 4px; width: 100%; font-size: 13px; }
        .input-box:focus { outline: 2px solid #3b82f6; background-color: #f0f9ff; }
        
        /* Letterhead - Responsive */
        .office-header { display: flex; align-items: center; border-bottom: 2px double #000; padding-bottom: 5px; margin-bottom: 15px; width: 100%; }
        .office-emblem { width: 85px; height: auto; object-fit: contain; }
        .header-text-container { flex-grow: 1; text-align: center; font-weight: bold; color: #ff0000; margin-right: 85px; line-height: 1.2; }
        
        .aadesh-table { width: 100%; border: 1px solid black; border-collapse: collapse; margin-top: 10px; }
        .aadesh-table td { border: 1px solid black; padding: 8px; vertical-align: top; }
        
        .tab-btn { padding: 5px 12px; border-radius: 15px; font-weight: bold; font-size: 11px; border: 1px solid #cbd5e1; }
        .tab-active { background-color: #1e40af; color: white; border-color: #1e40af; }
        .tab-inactive { background-color: white; color: #475569; }

        @media print {
            .no-print { display: none !important; }
            body { background: white; padding: 0; }
            .preview-page { 
                box-shadow: none; margin: 0; width: 100%; 
                padding: 0.5in 0.5in 0.5in 1.25in !important; /* Proper Punching Margin for Paper */
            }
        }
    </style>
</head>
<body class="p-2 md:p-4">

    <div class="max-w-[1950px] mx-auto grid grid-cols-1 xl:grid-cols-2 gap-4">
        
        <!-- बायाँ भाग: इन्पुट -->
        <div class="bg-white p-5 rounded-2xl shadow-xl border border-slate-300 overflow-y-auto max-h-[96vh] space-y-4 no-print text-sm">
            <div class="flex justify-between items-center border-b pb-2">
                <h2 class="text-xl font-bold text-slate-800">नामसारीको सुचना र आदेश</h2>
                <button onclick="resetData()" class="text-red-500 text-xs font-bold">Clear All</button>
            </div>

            <!-- १. प.सं. / मिति / अधिकृत -->
            <div class="grid grid-cols-2 gap-3 bg-slate-50 p-3 rounded-lg border">
                <div class="grid grid-cols-2 gap-1">
                    <div><label class="text-[10px] font-bold">प.सं.:</label><input type="text" id="in_p_s" oninput="updateAll()" placeholder="२०८१/८२" class="input-box"></div>
                    <div><label class="text-[10px] font-bold">च.नं.:</label><input type="text" id="in_c_n" oninput="updateAll()" placeholder="च.नं." class="input-box"></div>
                </div>
                <div><label class="text-[10px] font-bold">मिति:</label><input type="text" id="in_date" oninput="updateAll()" placeholder="२०८२।०९।१५" class="input-box"></div>
                <div><label class="text-[10px] font-bold">पद:</label><input type="text" id="in_officer" oninput="updateAll()" value="मालपोत अधिकृत" class="input-box"></div>
                <div><label class="text-[10px] font-bold">मिसिल नं.:</label><input type="text" id="in_misil" oninput="updateAll()" placeholder="मिसिल नं." class="input-box"></div>
            </div>

            <!-- २. निवेदक र मृतक -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
                <div class="bg-indigo-50 p-3 rounded-lg border border-indigo-100 space-y-2">
                    <div class="font-bold text-indigo-800 border-b pb-1 text-[10px] uppercase">निवेदक</div>
                    <input type="text" id="in_name" oninput="updateAll()" placeholder="निवेदकको नाम" class="input-box font-bold shadow-sm">
                    <div class="grid grid-cols-2 gap-2">
                        <input type="text" id="in_dist" oninput="updateAll()" value="सिन्धुपाल्चोक" class="input-box">
                        <input type="text" id="in_addr" oninput="updateAll()" placeholder="ठेगाना" class="input-box">
                    </div>
                    <div class="grid grid-cols-2 gap-2">
                        <input type="text" id="in_gf" oninput="updateAll()" placeholder="बाजे" class="input-box">
                        <input type="text" id="in_f" oninput="updateAll()" placeholder="बाबु" class="input-box">
                    </div>
                </div>
                <div class="bg-rose-50 p-3 rounded-lg border border-rose-100 space-y-2">
                    <div class="font-bold text-rose-800 border-b pb-1 text-[10px] uppercase">मृतक / ज.ध.</div>
                    <input type="text" id="in_m_name" oninput="updateAll()" placeholder="मृतकको नाम" class="input-box font-bold shadow-sm">
                    <div class="grid grid-cols-2 gap-2">
                        <input type="text" id="in_m_rel" oninput="updateAll()" placeholder="नाता" class="input-box">
                        <input type="text" id="in_m_date" oninput="updateAll()" placeholder="मृत्यु मिति" class="input-box">
                    </div>
                </div>
            </div>

            <!-- ३. जग्गा विवरण (UX Fixed) -->
            <div class="bg-green-50 p-3 rounded-lg border border-green-100 space-y-2">
                <div class="font-bold text-green-800 border-b pb-1 text-[10px] uppercase">जग्गाको विवरण</div>
                <div class="grid grid-cols-3 gap-2">
                    <input type="text" id="l_vdc" placeholder="गा.वि.स." class="input-box">
                    <input type="text" id="l_ward" placeholder="वडा" class="input-box">
                    <input type="text" id="l_kitta" placeholder="कि.नं." class="input-box">
                </div>
                <div class="flex gap-2">
                    <button onclick="addLand('same')" class="flex-1 bg-blue-600 text-white py-1 rounded font-bold shadow text-xs">+ सेम गा.वि.स.</button>
                    <button onclick="addLand('new')" class="flex-1 bg-green-700 text-white py-1 rounded font-bold shadow text-xs">+ नयाँ गा.वि.स.</button>
                </div>
                <div id="land-list-ui" class="flex flex-wrap gap-1 mt-1"></div>
            </div>

            <!-- ४. चिठ्ठी पठाउने निकाय र सिफारिस पठाएको निकाय -->
            <div class="bg-sky-50 p-3 rounded-lg border border-sky-100 space-y-2">
                <div class="grid grid-cols-2 gap-2">
                    <input type="text" id="in_t_n" oninput="updateAll()" value="श्री जिल्ला प्रशासन कार्यालय," class="input-box font-bold">
                    <input type="text" id="in_t_a" oninput="updateAll()" value="चौतारा, सिन्धुपाल्चोक ।" class="input-box">
                </div>
                <div class="grid grid-cols-3 gap-2">
                    <input type="text" id="in_s_auth" oninput="updateAll()" placeholder="सिफारिस गर्ने निकाय" class="input-box">
                    <input type="text" id="in_s_ch" oninput="updateAll()" placeholder="च.नं." class="input-box">
                    <input type="text" id="in_s_date" oninput="updateAll()" placeholder="मिति" class="input-box">
                </div>
                <div class="grid grid-cols-2 gap-2">
                    <input type="text" id="in_local" oninput="updateAll()" placeholder="स्थानीय तह" class="input-box">
                    <input type="text" id="in_paper" oninput="updateAll()" value="गोरखापत्र राष्ट्रिय दैनिक" class="input-box">
                </div>
            </div>

            <div class="bg-amber-50 p-3 rounded-lg border border-amber-100 space-y-1">
                <textarea id="in_faraka" oninput="updateAll()" placeholder="सुचना निकाल्नुको कारणः उदा नाम फरक परेकोले..." class="input-box h-10"></textarea>
            </div>

            <div class="grid grid-cols-2 gap-4 sticky bottom-0 bg-white pt-4">
                <button onclick="window.print()" class="bg-blue-900 text-white py-3 rounded-lg font-bold shadow-lg">प्रिन्ट गर्नुहोस्</button>
                <button onclick="exportAllToWord()" class="bg-slate-900 text-white py-3 rounded-lg font-bold shadow-lg">वर्डमा डाउनलोड</button>
            </div>
        </div>

        <!-- दायाँ भाग: प्रिभ्यु -->
        <div class="overflow-x-hidden max-h-[96vh]">
            <div class="flex justify-center gap-2 mb-4 no-print sticky top-0 bg-slate-200/90 backdrop-blur p-2 rounded-xl z-20">
                <button onclick="switchView('aadesh')" id="btn_aadesh" class="tab-btn tab-active">आदेश</button>
                <button onclick="switchView('suchana')" id="btn_suchana" class="tab-btn tab-inactive">सूचना</button>
                <button onclick="switchView('chithi')" id="btn_chithi" class="tab-btn tab-inactive">चिठ्ठी</button>
            </div>

            <div id="tippani-preview" class="preview-page">
                <div id="dynamic_body">
                    <!-- JavaScript will fill this -->
                </div>
            </div>
        </div>
    </div>

    <script>
        let lands = [];
        let currentView = 'aadesh';

        const toNepali = (num) => { if(!num) return ""; const n = ['०','१','२','३','४','५','६','७','८','९']; return num.toString().replace(/[0-9]/g, s => n[s]); };
        function nepaliJoin(arr) { if(!arr.length) return ""; if(arr.length===1) return arr[0]; const last = arr.pop(); return arr.join(', ') + ' र ' + last; }

        function addLand(type) {
            const vdc = document.getElementById('l_vdc').value;
            const ward = document.getElementById('l_ward').value;
            const kitta = toNepali(document.getElementById('l_kitta').value.trim());
            if(!kitta) return;
            let loc = lands.find(l => l.vdc === vdc && l.ward === ward);
            if(loc) { loc.kittas.push(kitta); } else { lands.push({ vdc, ward, kittas: [kitta] }); }
            document.getElementById('l_kitta').value = "";
            if(type === 'new') { document.getElementById('l_vdc').value = ""; document.getElementById('l_ward').value = ""; document.getElementById('l_vdc').focus(); }
            else { document.getElementById('l_kitta').focus(); }
            renderLandUI(); updateAll();
        }

        function renderLandUI() {
            document.getElementById('land-list-ui').innerHTML = lands.map((l, i) => `
                <div class="bg-white border p-1 px-2 rounded text-[10px] flex items-center gap-1 shadow-sm">
                    <b>${l.vdc}-${l.ward}:</b> ${l.kittas.join(',')}
                    <button onclick="lands.splice(${i},1); renderLandUI(); updateAll();" class="text-red-500">✕</button>
                </div>`).join('');
        }

        function switchView(view) {
            currentView = view;
            ['btn_aadesh', 'btn_suchana', 'btn_chithi'].forEach(b => document.getElementById(b).classList.replace('tab-active', 'tab-inactive'));
            document.getElementById('btn_' + view).classList.replace('tab-inactive', 'tab-active');
            updateAll();
        }

        function updateAll() {
            const d = {
                ps: document.getElementById('in_p_s').value || ".......",
                cn: toNepali(document.getElementById('in_c_n').value) || ".......",
                off: document.getElementById('in_officer').value,
                dt: document.getElementById('in_date').value || ".......",
                mis: toNepali(document.getElementById('in_misil').value) || ".......",
                name: document.getElementById('in_name').value || ".......",
                dist: document.getElementById('in_dist').value || ".......",
                addr: document.getElementById('in_addr').value || ".......",
                gf: document.getElementById('in_gf').value || ".......",
                f: document.getElementById('in_f').value || ".......",
                mn: document.getElementById('in_m_name').value || ".......",
                mr: document.getElementById('in_m_rel').value || ".......",
                md: document.getElementById('in_m_date').value || ".......",
                tn: document.getElementById('in_t_n').value || ".......",
                ta: document.getElementById('in_t_a').value || ".......",
                loc: document.getElementById('in_local').value || ".......",
                papr: document.getElementById('in_paper').value || "गोरखापत्र",
                sa: document.getElementById('in_s_auth').value || ".......",
                sc: toNepali(document.getElementById('in_s_ch').value) || ".......",
                sd: document.getElementById('in_s_date').value || ".......",
                frk: document.getElementById('in_faraka').value ? " " + document.getElementById('in_faraka').value : ""
            };

            const landText = lands.length > 0 ? lands.map(l => `साविक ${l.vdc} वडा नं. ${toNepali(l.ward)} को कि.नं. ${nepaliJoin([...l.kittas])}`).join(', ') : "साविक ....... वडा नं. ....... को कि.नं. .......";
            const commonBody = `यसमा ${d.dist} जिल्ला ${d.addr} बस्ने ${d.gf}को नाती ${d.f}को छोरा ${d.name} ले आफ्नो ${d.mr} ${d.mn} को मृत्यु भएकोले निजको नाममा दर्ता रहेको सिन्धुपाल्चोक जिल्ला ${landText} का जग्गाहरू नामसारी गरिपाउन निवेदन गरेकोमा निज जग्गाधनीको शेषपछिका हकवाला 'निवेदक' को नाममा नामसारी गरिदिन ${d.sa}को च.नं. ${d.sc} मिति ${d.sd} को सिफारिसबाट लेखि आएको ।${d.frk} भूमि प्रशासन निर्देशिका, २०८१ को दफा १९९ को उपदफा १ख बमोजिम थप प्रमाण बुझ्नुपर्ने देखियो । अतः उल्लिखित कित्ता जग्गाको हकभोग कसले गरेको छ ? निवेदकको माग बमोजिम नामसारी गरिदिँदा कोही कसैको हकभोगमा प्रतिकूल असर पर्छ/पर्दैन? यस अघि कोही कसैले नामसारी सम्बन्धमा यस कार्यालयबाट कार्यवाही चलाएको छ/छैन?`;
            const footerPara = ` मृतक ज.ध.को स्याहार सम्भार काजकिरिया गर्ने कोही व्यक्ति वा अरू कानूनी हकवाल भए यो सूचना प्रकाशित भएको मितिले ३५ दिनभित्र आफूसँग भएको सबुत प्रमाणहरू संलग्न राखी आफैं वा वारेस मार्फत दावी/उजुरी गर्न आउनुहोला/हकदावी गर्नुहोला । म्याद नाघी आएको दावी/उजुरी उपर कुनै कार्यवाही नहुने र नियमानुसार भई जाने व्यहोरा समेत यसै सूचनाद्वारा जानकारी गराइन्छ ।`;

            const letterhead = `
                <div class="office-header">
                    <img 
src="data:image/jpeg;base64,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"                    // class="office-emblem">
                    <div class="header-text-container">
                        <div style="font-size: 10pt;">नेपाल सरकार</div>
                        <div style="font-size: 11pt;">भूमि व्यवस्था, सहकारी तथा गरिबी निवारण मन्त्रालय</div>
                        <div style="font-size: 12pt; margin: 2px 0;">भूमि व्यवस्थापन तथा अभिलेख विभाग</div>
                        <div style="font-size: 18pt;">मालपोत कार्यालय</div>
                        <div style="font-size: 11pt;">चौतारा, सिन्धुपाल्चोक</div>
                    </div>
                </div>`;

            let bodyHtml = "";
            if(currentView === 'aadesh') {
                bodyHtml = `
                <div class="text-center font-bold mb-4 text-lg underline">टिप्पणी र आदेश</div>
                <div class="text-center font-bold mb-4 text-md">${d.off}बाट जारी भएको नामसारी सम्बन्धी आदेश</div>
                <table class="aadesh-table">
                    <tr>
                        <td style="width: 25%;"><b>निवेदक:</b> ${d.name}<br><b>मिति:</b> ${d.dt}<br><b>मि.नं.:</b> ${d.mis}</td>
                        <td style="font-size: 16px;">${commonBody}${footerPara}</td>
                    </tr>
                </table>`;
            } else if(currentView === 'suchana') {
                bodyHtml = `
                <div class="text-center font-bold mb-4 text-lg underline">हकदावी सम्बन्धी ३५ दिने सार्वजनिक सूचना</div>
                <div style="font-size: 17px; text-indent: 50px;">${commonBody}${footerPara}</div>`;
            } else {
                bodyHtml = `
                <div class="flex justify-between mb-4">
                    <div>पत्र सङ्ख्या: ${d.ps}<br>चलानी नं: ${d.cn}</div>
                    <div class="pt-6">मिति: ${d.dt}</div>
                </div>
                <div class="text-center font-bold mb-5 text-lg">विषय: सूचना टाँस गरी जानकारी पठाइदिने सम्बन्धमा ।</div>
                <div class="font-bold mb-4">${d.tn}<br>${d.ta}</div>
                <p style="text-indent: 50px;">प्रस्तुत विषयमा यस कार्यालयबाट प्रकाशित ${d.dist} जिल्ला ${d.addr} बस्ने ${d.name} ले मृतक ज.ध. ${d.mn} को नाममा रहेको जग्गा नामसारी गर्ने सम्बन्धमा प्रकाशित दिन ३५ (पैंतीस) को हकदावी/उजुरी सम्बन्धी सार्वजनीक सूचना थान-१ (एक) यसैसाथ संलग्न छ । उक्त सूचना तहाँ कार्यालयको सूचना पाटीमा टाँस गरी सोको जानकारी पठाइदिनुहुन अनुरोध गरिन्छ ।</p>
                <div class="flex justify-between mt-6">
                    <div class="text-[13px] leading-relaxed">
                        <b><u>बोधार्थ:</u></b><br>
                        १. श्री जिल्ला समन्वय समितीको कार्यालय, सिन्धुपाल्चोक: सूचना टाँस गरि जानकारी पठाइदिनुहुन ।<br>
                        २. श्री जिल्ला नापी कार्यालय, सिन्धुपाल्चोक: सूचना टाँस गरि जानकारी पठाइदिनुहुन ।<br>
                        ३. श्री ${d.loc}, सिन्धुपाल्चोक: सूचना टाँस गरि जानकारी पठाइदिनुहुन ।<br>
                        ४. श्री ${d.sa}, सिन्धुपाल्चोक: सूचना टाँस गरि जानकारी पठाइदिनुहुन ।<br>
                        ५. श्री ${d.papr}: सेवा शुल्क पत्र बाहकसँग असुल गरी सूचना प्रकाशित गरि दुई थान पत्रिका पठाइदिनुहुन ।
                    </div>
                    <div class="text-center pt-8">
                        ..........................................<br><span class="font-bold">${d.off}</span>
                    </div>
                </div>`;
            }
            document.getElementById('dynamic_body').innerHTML = letterhead + bodyHtml;
            saveToLocal();
        }

        async function exportAllToWord() {
            const views = ['aadesh', 'suchana', 'chithi'];
            for(let v of views) { switchView(v); await new Promise(r => setTimeout(r, 100)); exportCurrent(); }
        }

        function exportCurrent() {
            const n = document.getElementById('in_name').value || "file";
            const h = `<div style='mso-element:header' id=h1><table width="100%" style="border-collapse:collapse; border:none;"><tr><td width="100" style="border:none;"><img src="https://upload.wikimedia.org/wikipedia/commons/a/a3/Emblem_of_Nepal.svg" width="90"></td><td style="border:none; text-align:center; color:red; font-weight:bold; line-height:1.1;"><div style="font-size:10pt;">नेपाल सरकार</div><div style="font-size:11pt;">भूमि व्यवस्था, सहकारी तथा गरिबी निवारण मन्त्रालय</div><div style="font-size:13pt; margin:1pt 0;">भूमि व्यवस्थापन तथा अभिलेख विभाग</div><div style="font-size:18pt;">मालपोत कार्यालय</div><div style="font-size:11pt;">चौतारा, सिन्धुपाल्चोक</div></td></tr></table><div style="border-bottom:2.25pt double black; margin-top:5pt;"></div></div>`;
            const doc = `<html xmlns:o='urn:schemas-microsoft-com:office:office' xmlns:w='urn:schemas-microsoft-com:office:word' xmlns='http://www.w3.org/TR/REC-html40'><head><meta charset='utf-8'><style>@page Section1 { size: 8.5in 11in; margin: 1in 0.5in 1in 1.25in; mso-header-margin:.5in; mso-footer-margin:.5in; mso-header:h1; mso-footer:f1; } div.Section1 { page:Section1; } body { font-family:'Mukta', sans-serif; font-size:12pt; } table { border-collapse:collapse; width:100%; border:1px solid black; } td { border:1px solid black; padding:8pt; vertical-align:top; } p { text-align:justify; line-height:1.5; }</style></head><body><div class="Section1">${h}${document.getElementById('dynamic_body').innerHTML.split('</div>')[1]}<div style='mso-element:footer' id=f1><p style='text-align:right; font-size:10pt;'>पेज नं. <span style='mso-field-code:" PAGE "'></span> / <span style='mso-field-code:" NUMPAGES "'></span></p></div></div></body></html>`;
            const blob = new Blob(['\ufeff', doc], { type: 'application/msword' });
            const link = document.createElement("a"); link.href = URL.createObjectURL(blob); link.download = `(${n})-${currentView}.doc`; link.click();
        }

        function saveToLocal() { localStorage.setItem('namsari_v6', JSON.stringify({ lands, data: Array.from(document.querySelectorAll('input, textarea')).map(i => ({id: i.id, val: i.value})) })); }
        function loadFromLocal() {
            const raw = localStorage.getItem('namsari_v6');
            if(raw) { const d = JSON.parse(raw); lands = d.lands || []; d.data.forEach(item => { if(document.getElementById(item.id)) document.getElementById(item.id).value = item.val; }); renderLandUI(); updateAll(); }
        }
        function resetData() { if(confirm("Clear all?")) { localStorage.removeItem('namsari_v6'); location.reload(); } }
        window.onload = loadFromLocal;
    </script>
</body>
</html>