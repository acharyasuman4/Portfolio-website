<!DOCTYPE html>
<html lang="ne">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>рдирд╛рдорд╕рд╛рд░реА- рд╕реБрдЪрдирд╛ рдЖрджреЗрд╢-acharyasuman4</title>
    <link href="https://fonts.googleapis.com/css2?family=Mukta:wght@300;400;700&display=swap" rel="stylesheet">
    <style>
        /* RESET & BODY */
        * { box-sizing: border-box; }
        body { font-family: 'Mukta', sans-serif; background-color: #cbd5e1; margin: 0; padding: 0; height: 100vh; overflow: hidden; }

        /* LAYOUT CONTAINER */
        .main-layout { display: flex; height: 100vh; width: 100vw; }

        /* LEFT: INPUT PANEL */
        .input-panel { flex: 0 0 340px; background: white; padding: 15px; border-right: 1px solid #94a3b8; overflow-y: auto; height: 100%; z-index: 10; box-shadow: 2px 0 10px rgba(0, 0, 0, 0.1); }

        /* RIGHT: PREVIEW AREA */
        .preview-container { flex: 1; background: #94a3b8; display: flex; flex-direction: column; align-items: center; overflow-y: auto; padding: 20px 0; }
        .zoom-wrapper { transform: scale(0.85); transform-origin: top center; margin-bottom: -150px; }

        /* PAPER STYLE */
        .preview-page { background: white; width: 210mm; min-height: 297mm; padding: 2.54cm; box-shadow: 0 0 30px rgba(0, 0, 0, 0.5); text-align: justify; line-height: 1.5; font-size: 14pt; }

        /* INPUT STYLING */
        .input-group { margin-bottom: 12px; padding: 10px; border-radius: 8px; border: 1px solid #e2e8f0; background: #f8fafc; }
        .bg-indigo { background-color: #eef2ff; border-color: #c7d2fe; }
        .bg-rose { background-color: #fff1f2; border-color: #fecdd3; }
        .bg-green { background-color: #f0fdf4; border-color: #bbf7d0; }
        .bg-sky { background-color: #f0f9ff; border-color: #bae6fd; }

        label { display: block; font-size: 11px; font-weight: bold; margin-bottom: 2px; color: #475569; }
        .input-box { border: 1px solid #94a3b8; padding: 5px; border-radius: 4px; width: 100%; font-size: 13px; font-family: 'Mukta', sans-serif; }
        .input-box:focus { outline: 2px solid #2563eb; }

        .row-2 { display: grid; grid-template-columns: 1fr 1fr; gap: 8px; }
        .row-3 { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 8px; }

        /* LIST ITEMS */
        .list-item { background: white; padding: 3px 6px; border: 1px solid #ccc; border-radius: 4px; font-size: 11px; margin-top: 4px; display: flex; justify-content: space-between; align-items: center; }
        .del-btn { color: red; font-weight: bold; cursor: pointer; margin-left: 5px; }

        /* TABS */
        .tab-container { position: sticky; top: 0; z-index: 20; background: rgba(255, 255, 255, 0.9); padding: 8px 15px; border-radius: 30px; margin-bottom: 20px; box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1); backdrop-filter: blur(5px); }
        .tab-btn { padding: 8px 20px; border-radius: 20px; border: none; background: transparent; font-weight: bold; color: #64748b; cursor: pointer; font-size: 14px; }
        .tab-active { background-color: #1e40af; color: white; box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2); }

        /* BUTTONS */
        .btn { padding: 10px; border-radius: 6px; font-weight: bold; cursor: pointer; border: none; color: white; font-size: 13px; width: 100%; margin-top: 5px; }
        .btn:hover { opacity: 0.9; }
        .btn-blue { background-color: #2563eb; }
        .btn-dark { background-color: #0f172a; }
        .btn-add { background-color: #2563eb; color: white; border: none; border-radius: 4px; padding: 0 10px; cursor: pointer; font-weight: bold; }
        .btn-red { background-color: #ef4444; width: auto; font-size: 11px; padding: 4px 10px; float: right; }

        /* TABLE */
        .aadesh-table { width: 100%; border: 1px solid black; border-collapse: collapse; margin-top: 15px; }
        .aadesh-table td { border: 1px solid black; padding: 10px; vertical-align: top; font-size: 14pt; }

        /* PRINT MODE */
        @media print {
            @page { margin: 0.5in 0.5in 0.5in 1.25in; size: A4 portrait; }
            body { background: white; padding: 0; margin: 0; overflow: visible; height: auto; }
            .input-panel, .tab-container, button, .no-print { display: none !important; }
            .main-layout { display: block; height: auto; }
            .preview-container { display: block; background: white; padding: 0; overflow: visible; }
            .zoom-wrapper { transform: none; margin: 0; width: 100%; }
            .preview-page { box-shadow: none; margin: 0; width: 100%; padding: 0; min-height: auto; }
        }
    </style>
</head>

<body>

    <div class="main-layout">

        <!-- LEFT: INPUTS -->
        <div class="input-panel no-print">
            <div style="margin-bottom:15px; padding-bottom:10px; border-bottom:1px solid #e2e8f0; overflow:hidden;">
                <h2 style="margin:0; float:left; font-size:1.2rem; color:#1e293b;">рдирд╛рдорд╕рд╛рд░реА рд╡рд┐рд╡рд░рдг</h2>
                <button onclick="resetData()" class="btn btn-red">Reset</button>
            </div>

            <div class="input-group" style="background:#f8fafc;">
                <!-- HIDDEN PATRA SANKHYA -->
                <input type="hidden" id="in_p_s" value="режреореиредреорей">
                
                <div class="row-2">
                    <div><label>рдЪ.рдирдВ.:</label><input type="text" id="in_c_n" oninput="scheduleUpdate()" placeholder="рдЪ.рдирдВ." class="input-box"></div>
                    <div><label>рдорд┐рддрд┐:</label><input type="text" id="in_date" oninput="scheduleUpdate()" placeholder="реирежрео..." class="input-box"></div>
                </div>
                <div class="row-2" style="margin-top:8px;">
                    <div><label>рдкрдж:</label><input type="text" id="in_officer" oninput="scheduleUpdate()" value="рдорд╛рд▓рдкреЛрдд рдЕрдзрд┐рдХреГрдд" class="input-box"></div>
                    <div><label>рдорд┐рд╕рд┐рд▓:</label><input type="text" id="in_misil" oninput="scheduleUpdate()" placeholder="рдирдВ." class="input-box"></div>
                </div>
            </div>

            <!-- APPLICANT SECTION (ORIGINAL STYLE) -->
            <div class="input-group bg-indigo">
                <div style="font-weight:bold; color:#3730a3; margin-bottom:8px; font-size:12px;">рез. рдирд┐рд╡реЗрджрдХ</div>
                
                <div style="display:flex; gap:5px; margin-bottom:8px;">
                    <input type="text" id="in_app_name" placeholder="рдирд┐рд╡реЗрджрдХрдХреЛ рдирд╛рдо" class="input-box" style="font-weight:bold; flex:1;">
                    <select id="in_rel_type" onchange="updatePlaceholders()" class="input-box" style="width:auto; font-size:11px;">
                        <option value="son">рдЫреЛрд░рд╛/рдирд╛рддрд┐</option>
                        <option value="daughter">рдЫреЛрд░реА/рдирд╛рддрд┐рдиреА</option>
                        <option value="wife">рдкрддреНрдиреА/рдмреБрд╣рд╛рд░реА</option>
                    </select>
                </div>
                
                <div class="row-2" style="margin-bottom:8px;">
                    <input type="text" id="in_dist" oninput="scheduleUpdate()" value="рд╕рд┐рдиреНрдзреБрдкрд╛рд▓реНрдЪреЛрдХ" class="input-box">
                    <input type="text" id="in_addr" placeholder="рдареЗрдЧрд╛рдирд╛" class="input-box">
                </div>
                <div class="row-2">
                    <input type="text" id="in_f" placeholder="рдмрд╛рдмреБ" class="input-box">
                    <input type="text" id="in_gf" placeholder="рдмрд╛рдЬреЗ" class="input-box">
                </div>
                 <button onclick="addApplicant()" class="btn-add" style="padding: 5px 10px;">рдирд┐рд╡реЗрджрдХ рдердкреНрдиреБрд╣реЛрд╕реН+</button>

                <div id="applicant-list-ui" style="margin-top:5px;"></div>
            </div>

            <!-- DECEASED SECTION -->
            <div class="input-group bg-rose">
                <div style="font-weight:bold; color:#9f1239; margin-bottom:8px; font-size:12px;">реи. рдореГрддрдХ / рдЬ.рдз. (рдПрдХ рд╡рд╛ рдзреЗрд░реИ)</div>
                <div class="row-3" style="margin-bottom:5px;">
                    <input type="text" id="in_m_rel" placeholder="рдирд╛рддрд╛" class="input-box">
                    <input type="text" id="in_m_name" placeholder="рдореГрддрдХрдХреЛ рдирд╛рдо" class="input-box" style="font-weight:bold;">
                    <input type="text" id="in_m_date" placeholder="рдореГрддреНрдпреБ рдорд┐рддрд┐" class="input-box">
                </div>
                <button onclick="addDeceased()" class="btn btn-dark" style="background:#be123c; padding:5px;">+ рдореГрддрдХ рдердкреНрдиреБрд╣реЛрд╕реН</button>
                <div id="deceased-list-ui" style="margin-top:5px;"></div>
            </div>

            <!-- LAND SECTION -->
            <div class="input-group bg-green">
                <div style="font-weight:bold; color:#166534; margin-bottom:8px; font-size:12px;">рей. рдЬрдЧреНрдЧрд╛рдХреЛ рд╡рд┐рд╡рд░рдг</div>
                <div class="row-3" style="margin-bottom:8px;">
                    <input type="text" id="l_vdc" placeholder="рдЧрд╛.рд╡рд┐.рд╕." class="input-box">
                    <input type="text" id="l_ward" placeholder="рд╡рдбрд╛" class="input-box">
                    <input type="text" id="l_kitta" placeholder="рдХрд┐.рдирдВ." class="input-box">
                </div>
                <div style="display:flex; gap:8px;">
                    <button onclick="addLand('same')" class="btn btn-blue" style="padding:5px; font-size:11px;">+ Same VDC</button>
                    <button onclick="addLand('new')" class="btn btn-dark" style="background:#15803d; padding:5px; font-size:11px;">+ New VDC</button>
                </div>
                <div id="land-list-ui" style="margin-top:10px; display:flex; flex-wrap:wrap; gap:5px;"></div>
            </div>

            <!-- OTHER DETAILS -->
            <div class="input-group bg-sky">
                <div class="row-2" style="margin-bottom:8px;">
                    <input type="text" id="in_t_n" oninput="scheduleUpdate()" value="рд╢реНрд░реА рдЬрд┐рд▓реНрд▓рд╛ рдкреНрд░рд╢рд╛рд╕рди рдХрд╛рд░реНрдпрд╛рд▓рдп," class="input-box">
                    <input type="text" id="in_t_a" oninput="scheduleUpdate()" value="рдЪреМрддрд╛рд░рд╛, рд╕рд┐рдиреНрдзреБрдкрд╛рд▓реНрдЪреЛрдХ ред" class="input-box">
                </div>
                <div class="row-3" style="margin-bottom:8px;">
                    <input type="text" id="in_s_auth" oninput="scheduleUpdate()" placeholder="рд╕рд┐рдлрд╛рд░рд┐рд╕ рдЧрд░реНрдиреЗ" class="input-box">
                    <input type="text" id="in_s_ch" oninput="scheduleUpdate()" placeholder="рдЪ.рдирдВ." class="input-box">
                    <input type="text" id="in_s_date" oninput="scheduleUpdate()" placeholder="рдорд┐рддрд┐" class="input-box">
                </div>
                <div class="row-2">
                    <input type="text" id="in_local" oninput="scheduleUpdate()" placeholder="рд╕реНрдерд╛рдиреАрдп рддрд╣" class="input-box">
                    <input type="text" id="in_paper" oninput="scheduleUpdate()" value="рдЧреЛрд░рдЦрд╛рдкрддреНрд░ рд░рд╛рд╖реНрдЯреНрд░рд┐рдп рджреИрдирд┐рдХ" class="input-box">
                </div>
            </div>

            <div class="input-group" style="background:#fffbeb; border-color:#fcd34d;">
                <div class="row-3">
                    <div><label>рдЙрдкрджрдлрд╛:</label><input type="text" id="in_upadafa" oninput="scheduleUpdate()" value="резрдЦ" class="input-box"></div>
                    <div style="grid-column: span 2;"><label>рдХрд╛рд░рдг:</label><input type="text" id="in_faraka" oninput="scheduleUpdate()" placeholder="... рдлрд░рдХ рдкрд░реЗрдХреЛрд▓реЗ" class="input-box"></div>
                </div>
            </div>
                            <P style="font-size: 10px;"><b>рдЫреЛрд░рд╛, рдЫреЛрд░реА, рдкрддрд┐ рд╡рд╛ рдкрддреНрдиреАрдорд╛</b> рд╡реНрдпрд╣реЛрд░рд╛ рдлрд░рдХ рдкрд░реЗрдХреЛрдорд╛ <b>резрда</b></P>


            <div style="margin-top:15px; display:grid; gap:8px;">
                <button onclick="window.print()" class="btn btn-blue">ЁЯЦия╕П рд╕рд┐рдзреИ рдкреНрд░рд┐рдиреНрдЯ (Print)</button>
                <button onclick="exportAllToWord()" class="btn btn-dark">ЁЯУД рд╡рд░реНрдбрдорд╛ рдбрд╛рдЙрдирд▓реЛрдб (Word)</button>
                          <br>      <a href="https://fonts.google.com/download?family=Mukta" class="btn"
                    style="background-color:#475569; text-decoration:none; text-align:center; display:block; margin-top:5px;">
                    ЁЯУе рдлрдиреНрдЯ рдбрд╛рдЙрдирд▓реЛрдб (Mukta Font)
                </a>

            </div>
        </div>

        <!-- RIGHT: PREVIEW (ZOOMED) -->
        <div class="preview-container">
            <div class="tab-container no-print">
                <button onclick="switchView('aadesh')" id="btn_aadesh" class="tab-btn tab-active">рдЖрджреЗрд╢</button>
                <button onclick="switchView('suchana')" id="btn_suchana" class="tab-btn">рд╕реВрдЪрдирд╛</button>
                <button onclick="switchView('chithi')" id="btn_chithi" class="tab-btn">рдЪрд┐рдареНрдареА</button>
            </div>

            <div class="zoom-wrapper">
                <div id="tippani-preview" class="preview-page">
                    <div id="dynamic_body">
                        <!-- JS CONTENT -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // --- GLOBAL VARIABLES ---
        let lands = [];
        let applicants = []; // Array to store multiple applicants
        let deceasedList = []; // Array to store multiple deceased
        let currentView = 'aadesh';
        let debounceTimer;

        // --- HELPER FUNCTIONS ---
        const toNepali = (num) => { if (!num && num !== 0) return ""; const n = ['реж', 'рез', 'реи', 'рей', 'рек', 'рел', 'рем', 'рен', 'рео', 'реп']; return num.toString().replace(/[0-9]/g, s => n[s]); };
        
        function nepaliJoin(arr) { 
            if (!arr.length) return ""; 
            if (arr.length === 1) return arr[0]; 
            const last = arr.pop(); 
            return arr.join(', ') + ' рд░ ' + last; 
        }

        function scheduleUpdate() { clearTimeout(debounceTimer); debounceTimer = setTimeout(() => { updateAll(); saveToLocal(); }, 300); }

        // --- 1. APPLICANT LOGIC (UPDATED) ---
        function updatePlaceholders() {
            const rel = document.getElementById('in_rel_type').value;
            if (rel === 'wife') {
                document.getElementById('in_gf').placeholder = "рд╕рд╕реБрд░рд╛рдХреЛ рдирд╛рдо";
                document.getElementById('in_f').placeholder = "рдкрддрд┐рдХреЛ рдирд╛рдо";
            } else {
                document.getElementById('in_gf').placeholder = "рдмрд╛рдЬреЗрдХреЛ рдирд╛рдо";
                document.getElementById('in_f').placeholder = "рдмрд╛рдмреБрдХреЛ рдирд╛рдо";
            }
        }

        function addApplicant() {
            const name = document.getElementById('in_app_name').value.trim();
            const relType = document.getElementById('in_rel_type').value;
            const dist = document.getElementById('in_dist').value.trim();
            const addr = document.getElementById('in_addr').value.trim();
            const gf = document.getElementById('in_gf').value.trim();
            const f = document.getElementById('in_f').value.trim();

            if (!name) { alert("рдирд┐рд╡реЗрджрдХрдХреЛ рдирд╛рдо рдЕрдирд┐рд╡рд╛рд░реНрдп рдЫред"); return; }

            // Store object
            applicants.push({ name, relType, dist, addr, gf, f });

            // CLEAR ONLY NAME (Keep Address, Father, Grandfather for siblings)
            document.getElementById('in_app_name').value = "";
            document.getElementById('in_app_name').focus(); // Focus back to name

            renderApplicantUI();
            scheduleUpdate();
        }

        function renderApplicantUI() {
            const relMap = { son: 'рдЫреЛрд░рд╛', daughter: 'рдЫреЛрд░реА', wife: 'рдкрддреНрдиреА' };
            document.getElementById('applicant-list-ui').innerHTML = applicants.map((app, i) => `
                <div class="list-item">
                    <span>${app.name} (${relMap[app.relType]})</span>
                    <span class="del-btn" onclick="applicants.splice(${i},1); renderApplicantUI(); scheduleUpdate();">├Ч</span>
                </div>
            `).join('');
        }

        // --- 2. DECEASED LOGIC ---
        function addDeceased() {
            const name = document.getElementById('in_m_name').value.trim();
            const rel = document.getElementById('in_m_rel').value.trim();
            const date = document.getElementById('in_m_date').value.trim();
            
            if (!name) return;
            deceasedList.push({ name, rel, date });
            
            document.getElementById('in_m_name').value = "";
            document.getElementById('in_m_rel').value = "";
            document.getElementById('in_m_date').value = "";
            document.getElementById('in_m_name').focus();
            
            renderDeceasedUI(); scheduleUpdate();
        }

        function renderDeceasedUI() {
            document.getElementById('deceased-list-ui').innerHTML = deceasedList.map((d, i) => `
                <div class="list-item">
                    <span>${d.rel} <b>${d.name}</b> (${d.date})</span>
                    <span class="del-btn" onclick="deceasedList.splice(${i},1); renderDeceasedUI(); scheduleUpdate();">├Ч</span>
                </div>
            `).join('');
        }

        // --- 3. LAND LOGIC ---
        function addLand(type) {
            const vdc = document.getElementById('l_vdc').value;
            const ward = document.getElementById('l_ward').value;
            const kitta = toNepali(document.getElementById('l_kitta').value.trim());
            
            if (!kitta) return;
            let loc = lands.find(l => l.vdc === vdc && l.ward === ward);
            if (loc) { loc.kittas.push(kitta); } else { lands.push({ vdc, ward, kittas: [kitta] }); }
            
            document.getElementById('l_kitta').value = "";
            if (type === 'new') { 
                document.getElementById('l_vdc').value = ""; 
                document.getElementById('l_ward').value = ""; 
                document.getElementById('l_vdc').focus(); 
            } else { 
                document.getElementById('l_kitta').focus(); 
            }
            renderLandUI(); scheduleUpdate();
        }

        function renderLandUI() {
            document.getElementById('land-list-ui').innerHTML = lands.map((l, i) => `
                <div class="list-item" style="background:#f1f5f9;">
                    <b>${l.vdc}-${l.ward}:</b> ${l.kittas.join(',')}
                    <span class="del-btn" onclick="lands.splice(${i},1); renderLandUI(); scheduleUpdate();">├Ч</span>
                </div>`).join('');
        }

        function switchView(view) {
            currentView = view;
            ['btn_aadesh', 'btn_suchana', 'btn_chithi'].forEach(b => document.getElementById(b).className = 'tab-btn');
            document.getElementById('btn_' + view).className = 'tab-btn tab-active';
            updateAll();
        }

        // --- 4. DATA PROCESSING & TEXT GENERATION ---
        function getData() {
            // Fallback for single user (if they typed but didn't click +)
            let finalApplicants = [...applicants];
            if (finalApplicants.length === 0 && document.getElementById('in_app_name').value) {
                finalApplicants.push({
                    name: document.getElementById('in_app_name').value,
                    relType: document.getElementById('in_rel_type').value,
                    dist: document.getElementById('in_dist').value,
                    addr: document.getElementById('in_addr').value,
                    gf: document.getElementById('in_gf').value,
                    f: document.getElementById('in_f').value
                });
            }

            return {
                ps: document.getElementById('in_p_s').value || "режреореиредреорей",
                cn: toNepali(document.getElementById('in_c_n').value) || ".......",
                off: document.getElementById('in_officer').value,
                dt: document.getElementById('in_date').value || ".......",
                mis: toNepali(document.getElementById('in_misil').value) || ".......",
                applicants: finalApplicants,
                deceasedList: deceasedList,
                tn: document.getElementById('in_t_n').value || ".......",
                ta: document.getElementById('in_t_a').value || ".......",
                loc: document.getElementById('in_local').value || ".......",
                papr: document.getElementById('in_paper').value || ".........",
                sa: document.getElementById('in_s_auth').value || ".......",
                sc: toNepali(document.getElementById('in_s_ch').value) || ".......",
                sd: document.getElementById('in_s_date').value || ".......",
                frk: document.getElementById('in_faraka').value ? " " + document.getElementById('in_faraka').value : "",
                upadafa: document.getElementById('in_upadafa').value || "резрдЦ"
            };
        }

        function generateTexts(d) {
            // A. Applicant Text Logic (Grouping)
            let groupedApps = {};
            let address = "";
            let district = "";

            if (d.applicants.length > 0) {
                district = d.applicants[0].dist;
                address = d.applicants[0].addr; // Take first address as primary
                
                d.applicants.forEach(app => {
                    let key = "";
                    if (app.relType === 'wife') {
                        key = `${app.gf}рдХреЛ рдмреБрд╣рд╛рд░реА ${app.f}рдХреЛ рдкрддреНрдиреА`;
                    } else if (app.relType === 'daughter') {
                        key = `${app.gf}рдХреЛ рдирд╛рддрд┐рдиреА ${app.f}рдХреЛ рдЫреЛрд░реА`;
                    } else {
                        key = `${app.gf}рдХреЛ рдирд╛рддрд┐ ${app.f}рдХреЛ рдЫреЛрд░рд╛`;
                    }
                    if (!groupedApps[key]) groupedApps[key] = [];
                    groupedApps[key].push(app.name);
                });
            } else {
                groupedApps["....... рдХреЛ рдирд╛рддрд┐ ....... рдХреЛ рдЫреЛрд░рд╛"] = ["......."];
                district = ".......";
                address = ".......";
            }

            let appStrings = [];
            for (let [desc, names] of Object.entries(groupedApps)) {
                appStrings.push(`${desc} ${nepaliJoin(names)}`);
            }
            const applicantFullDesc = nepaliJoin(appStrings);
            const applicantNamesOnly = d.applicants.length > 0 ? nepaliJoin(d.applicants.map(a => a.name)) : ".......";

            // B. Deceased Text Logic
            let deathReason = "";
            let deceasedNames = "";
            let ownerGrammar = "рдирд┐рдЬ рдЬрдЧреНрдЧрд╛рдзрдиреАрдХреЛ";

            if (d.deceasedList.length > 0) {
                const deathParts = d.deceasedList.map(item => `${item.rel} ${item.name}рдХреЛ рдорд┐рддрд┐ ${item.date} рдорд╛`);
                deathReason = "рдЖрдлреНрдиреЛ " + nepaliJoin(deathParts) + " рдореГрддреНрдпреБ рднрдПрдХреЛрд▓реЗ";
                deceasedNames = nepaliJoin(d.deceasedList.map(i => i.name));
                if (d.deceasedList.length > 1) ownerGrammar = "рдирд┐рдЬ рдЬрдЧреНрдЧрд╛рдзрдиреАрд╣рд░реВрдХреЛ";
            } else {
                deathReason = "рдЖрдлреНрдиреЛ ....... рдХреЛ рдорд┐рддрд┐ ....... рдорд╛ рдореГрддреНрдпреБ рднрдПрдХреЛрд▓реЗ";
                deceasedNames = ".......";
            }

            // C. Land Text Logic
            let totalKittas = 0;
            lands.forEach(l => totalKittas += l.kittas.length);
            const landGrammar = totalKittas === 1 ? "рдХреЛ рдЬрдЧреНрдЧрд╛" : "рдХрд╛ рдЬрдЧреНрдЧрд╛рд╣рд░реВ";
            const landText = lands.length > 0 ? lands.map(l => `рд╕рд╛рд╡рд┐рдХ ${l.vdc} рд╡рдбрд╛ рдирдВ. ${toNepali(l.ward)} рдХреЛ рдХрд┐.рдирдВ. ${nepaliJoin([...l.kittas])}`).join(', ') : "рд╕рд╛рд╡рд┐рдХ ....... рд╡рдбрд╛ рдирдВ. ....... рдХреЛ рдХрд┐.рдирдВ. .......";

            return { district, address, applicantFullDesc, applicantNamesOnly, deathReason, deceasedNames, ownerGrammar, landGrammar, landText };
        }

        function updateAll() {
            const d = getData();
            const t = generateTexts(d);

            const letterhead = `
                <table style="width: 100%; border-bottom: 2px double black; margin-bottom: 15px; border-collapse: collapse; border: none;">
                    <tr>
                        <td style="width: 15%; text-align: left; vertical-align: top; border: none;">
                            <img 
                        src="data:image/jpeg;base64,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">
                        </td>
                        <td style="text-align: center; color: red; vertical-align: top; border: none; line-height: 1.1;">
                            <div style="font-size: 10pt; font-weight: bold;">рдиреЗрдкрд╛рд▓ рд╕рд░рдХрд╛рд░</div>
                            <div style="font-size: 11pt; font-weight: bold;">рднреВрдорд┐ рд╡реНрдпрд╡рд╕реНрдерд╛, рд╕рд╣рдХрд╛рд░реА рддрдерд╛ рдЧрд░рд┐рдмреА рдирд┐рд╡рд╛рд░рдг рдордиреНрддреНрд░рд╛рд▓рдп</div>
                            <div style="font-size: 12pt; font-weight: bold;">рднреВрдорд┐ рд╡реНрдпрд╡рд╕реНрдерд╛рдкрди рддрдерд╛ рдЕрднрд┐рд▓реЗрдЦ рд╡рд┐рднрд╛рдЧ</div>
                            <div style="font-size: 16pt; font-weight: bold;">рдорд╛рд▓рдкреЛрдд рдХрд╛рд░реНрдпрд╛рд▓рдп</div>
                            <div style="font-size: 11pt; font-weight: bold;">рдЪреМрддрд╛рд░рд╛, рд╕рд┐рдиреНрдзреБрдкрд╛рд▓реНрдЪреЛрдХ</div>
                        </td>
                        <td style="width: 15%; border: none;"></td>
                    </tr>
                </table>`;

            const commonBody = `рдпрд╕рдорд╛ ${t.district} рдЬрд┐рд▓реНрд▓рд╛ ${t.address} рдмрд╕реНрдиреЗ ${t.applicantFullDesc}рд▓реЗ ${t.deathReason} ${t.ownerGrammar} рдирд╛рдордорд╛ рджрд░реНрддрд╛ рд░рд╣реЗрдХреЛ рд╕рд┐рдиреНрдзреБрдкрд╛рд▓реНрдЪреЛрдХ рдЬрд┐рд▓реНрд▓рд╛ ${t.landText} ${t.landGrammar} рдирд╛рдорд╕рд╛рд░реА рдЧрд░рд┐рдкрд╛рдЙрди рдирд┐рд╡реЗрджрди рдЧрд░реЗрдХреЛрдорд╛ ${t.ownerGrammar} рд╢реЗрд╖рдкрдЫрд┐рдХрд╛ рд╣рдХрд╡рд╛рд▓рд╛ ${t.applicantNamesOnly}рдХреЛ рдирд╛рдордорд╛ рдирд╛рдорд╕рд╛рд░реА рдЧрд░рд┐рджрд┐рди ${d.sa}рдХреЛ рдЪ.рдирдВ. ${d.sc} рдорд┐рддрд┐ ${d.sd} рдХреЛ рд╕рд┐рдлрд╛рд░рд┐рд╕рдмрд╛рдЯ рд▓реЗрдЦрд┐ рдЖрдПрдХреЛ ред${d.frk}`;

            const aadeshBody = `${commonBody} рднреВрдорд┐ рдкреНрд░рд╢рд╛рд╕рди рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛, реирежреорез рдХреЛ рджрдлрд╛ резрепреп рдХреЛ рдЙрдкрджрдлрд╛ ${d.upadafa} рдмрдореЛрдЬрд┐рдо рдердк рдкреНрд░рдорд╛рдг рдмреБрдЭреНрдиреБрдкрд░реНрдиреЗ рджреЗрдЦрд┐рдпреЛ ред рдЕрддрдГ рдЙрд▓реНрд▓рд┐рдЦрд┐рдд рдХрд┐рддреНрддрд╛ рдЬрдЧреНрдЧрд╛рдХреЛ рд╣рдХрднреЛрдЧ рдХрд╕рд▓реЗ рдЧрд░реЗрдХреЛ рдЫ ? рдирд┐рд╡реЗрджрдХрдХреЛ рдорд╛рдЧ рдмрдореЛрдЬрд┐рдо рдирд╛рдорд╕рд╛рд░реА рдЧрд░рд┐рджрд┐рдБрджрд╛ рдХреЛрд╣реА рдХрд╕реИрдХреЛ рд╣рдХрднреЛрдЧрдорд╛ рдкреНрд░рддрд┐рдХреВрд▓ рдЕрд╕рд░ рдкрд░реНрдЫ/рдкрд░реНрджреИрди? рдпрд╕ рдЕрдШрд┐ рдХреЛрд╣реА рдХрд╕реИрд▓реЗ рдирд╛рдорд╕рд╛рд░реА рд╕рдореНрдмрдиреНрдзрдорд╛ рдпрд╕ рдХрд╛рд░реНрдпрд╛рд▓рдпрдмрд╛рдЯ рдХрд╛рд░реНрдпрд╡рд╛рд╣реА рдЪрд▓рд╛рдПрдХреЛ рдЫ/рдЫреИрди? рд▓рдЧрд╛рдпрддрдХрд╛ рдЙрд▓реНрд▓рд┐рдЦрд┐рдд рд╕рдореНрдкреВрд░реНрдг рд╡реНрдпрд╣реЛрд░рд╛ рдЦреБрд▓рд╛рдИ рд╣рдХрджрд╛рд╡реА рд╕рдореНрдмрдиреНрдзрдорд╛ рейрел рджрд┐рдиреЗ рд╕рд╛рд░реНрд╡рдЬрд╛рдирд┐рдХ рд╕реВрдЪрдирд╛ рдореБрд▓реБрдХреА рджреЗрд╡рд╛рдиреА рдХрд╛рд░реНрдпрд╡рд┐рдзрд┐ рд╕рдВрд╣рд┐рддрд╛, реирежренрек рдХреЛ рджрдлрд╛ реиреореи рдмрдореЛрдЬрд┐рдо ${d.papr}рдорд╛ рд╕рдореЗрдд рдкреНрд░рдХрд╛рд╢рд┐рдд рдЧрд░реНрдиреВ ред рд╕реВрдЪрдирд╛рдХреЛ рдореНрдпрд╛рджрднрд┐рддреНрд░ рджрд╛рд╡рд┐ рдкрд░реЗ рдорд┐рд╕рд┐рд▓ рд╕рд╛рдореЗрд▓ рдЧрд░рд┐ рд░ рдирдкрд░реЗ рдореНрдпрд╛рдж рднреБрдХреНрддрд╛рди рднрдПрдкрдЫрд┐ рд╕реВрдЪрдирд╛ рдкреНрд░рдХрд╛рд╢рд┐рдд рднрдПрдХреЛ рдкрддреНрд░рд┐рдХрд╛ рд░ рд╕реВрдЪрдирд╛ рдЯрд╛рдБрд╕рдХреЛ рдЬрд╛рдирдХрд╛рд░реА рд╕рдореЗрдд рдорд┐рд╕рд┐рд▓ рд╕рд╛рдореЗрд▓ рдЧрд░реА рдкреЗрд╢ рдЧрд░реНрдиреВ ред`;

            const suchanaBody = `${commonBody} рдореГрддрдХ рдЬ.рдз.рдХреЛ рд╕реНрдпрд╛рд╣рд╛рд░ рд╕рдореНрднрд╛рд░ рдХрд╛рдЬрдХрд┐рд░рд┐рдпрд╛ рдЧрд░реНрдиреЗ рдХреЛрд╣реА рд╡реНрдпрдХреНрддрд┐ рд╡рд╛ рдЕрд░реВ рдХрд╛рдиреВрдиреА рд╣рдХрд╡рд╛рд▓рд╛ рднрдП рдпреЛ рд╕реВрдЪрдирд╛ рдкреНрд░рдХрд╛рд╢рд┐рдд рднрдПрдХреЛ рдорд┐рддрд┐рд▓реЗ рейрел рджрд┐рдирднрд┐рддреНрд░ рдЖрдлреВрд╕рдБрдЧ рднрдПрдХреЛ рд╕рдмреБрдд рдкреНрд░рдорд╛рдгрд╣рд░реВ рд╕рдВрд▓рдЧреНрди рд░рд╛рдЦреА рдЖрдлреИрдВ рд╡рд╛ рд╡рд╛рд░реЗрд╕ рдорд╛рд░реНрдлрдд рджрд╛рд╡реА/рдЙрдЬреБрд░реА рдЧрд░реНрди рдЖрдЙрдиреБрд╣реЛрд▓рд╛/рд╣рдХрджрд╛рд╡реА рдЧрд░реНрдиреБрд╣реЛрд▓рд╛ ред рдореНрдпрд╛рдж рдирд╛рдШреА рдЖрдПрдХреЛ рджрд╛рд╡реА/рдЙрдЬреБрд░реА рдЙрдкрд░ рдХреБрдиреИ рдХрд╛рд░реНрдпрд╡рд╛рд╣реА рдирд╣реБрдиреЗ рд░ рдирд┐рдпрдорд╛рдиреБрд╕рд╛рд░ рднрдИ рдЬрд╛рдиреЗ рд╡реНрдпрд╣реЛрд░рд╛ рд╕рдореЗрдд рдпрд╕реИ рд╕реВрдЪрдирд╛рджреНрд╡рд╛рд░рд╛ рдЬрд╛рдирдХрд╛рд░реА рдЧрд░рд╛рдЗрдиреНрдЫ ред`;

            let bodyHtml = "";

            if (currentView === 'aadesh') {
                bodyHtml = `
                ${letterhead}
                <div style="text-align:center; font-weight:bold; text-decoration:underline; font-size:16pt; margin-bottom:15px; margin-top:20px;">${d.off}рдмрд╛рдЯ рдЬрд╛рд░реА рднрдПрдХреЛ рд╣рдХрджрд╛рд╡реА рд╕рдореНрдмрдиреНрдзреА рдЖрджреЗрд╢</div>
                <table class="aadesh-table">
                    <tr>
                        <td style="width: 25%; font-size: 14pt;"><b>рдирд┐рд╡реЗрджрдХ:</b><br>${t.applicantNamesOnly}<br><br><b>рдорд┐рддрд┐:</b> ${d.dt}<br><b>рдорд┐.рдирдВ.:</b> ${d.mis}</td>
                        <td style="font-size: 14pt; text-align: justify;">${aadeshBody}</td>
                    </tr>
                </table>`;
            } else if (currentView === 'suchana') {
                bodyHtml = `
                ${letterhead}
                <div style="text-align:center; font-weight:bold; text-decoration:underline; font-size:16pt; margin-bottom:15px; margin-top:20px;">рд╣рдХрджрд╛рд╡реА рд╕рдореНрдмрдиреНрдзреА рейрел рджрд┐рдиреЗ рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рд╕реВрдЪрдирд╛</div>
                <div style="font-size: 14pt; text-indent: 50px; text-align: justify;">${suchanaBody}</div>`;
            } else {
                bodyHtml = `
                ${letterhead}
                <div style="display:flex; justify-content:space-between; margin-bottom:10px; font-size:14pt;"><div>рдкрддреНрд░ рд╕рдЩреНрдЦреНрдпрд╛: ${d.ps}<br>рдЪрд▓рд╛рдиреА рдирдВ: ${d.cn}</div><div style="padding-top:20px;">рдорд┐рддрд┐: ${d.dt}</div></div>
                <div style="text-align:center; font-weight:bold; margin-bottom:15px; font-size:16pt;">рд╡рд┐рд╖рдп: рд╕реВрдЪрдирд╛ рдЯрд╛рдБрд╕ рдЧрд░реА рдЬрд╛рдирдХрд╛рд░реА рдкрдард╛рдЗрджрд┐рдиреЗ рд╕рдореНрдмрдиреНрдзрдорд╛ ред</div>
                <div style="font-weight:bold; margin-bottom:10px; font-size:14pt;">${d.tn}<br>${d.ta}</div>
                <p style="text-indent: 50px; font-size: 14pt; margin-bottom: 10px; text-align: justify;">рдкреНрд░рд╕реНрддреБрдд рд╡рд┐рд╖рдпрдорд╛ рдпрд╕ рдХрд╛рд░реНрдпрд╛рд▓рдпрдмрд╛рдЯ рдкреНрд░рдХрд╛рд╢рд┐рдд ${t.district} рдЬрд┐рд▓реНрд▓рд╛ ${t.address} рдмрд╕реНрдиреЗ ${t.applicantNamesOnly}рд▓реЗ рдореГрддрдХ рдЬ.рдз. ${t.deceasedNames}рдХреЛ рдирд╛рдордорд╛ рд░рд╣реЗрдХреЛ рдЬрдЧреНрдЧрд╛ рдирд╛рдорд╕рд╛рд░реА рдЧрд░реНрдиреЗ рд╕рдореНрдмрдиреНрдзрдорд╛ рдкреНрд░рдХрд╛рд╢рд┐рдд рджрд┐рди рейрел (рдкреИрдВрддреАрд╕) рдХреЛ рд╣рдХрджрд╛рд╡реА/рдЙрдЬреБрд░реА рд╕рдореНрдмрдиреНрдзреА рд╕рд╛рд░реНрд╡рдЬрдиреАрдХ рд╕реВрдЪрдирд╛ рдерд╛рди-рез (рдПрдХ) рдпрд╕реИрд╕рд╛рде рд╕рдВрд▓рдЧреНрди рдЫ ред рдЙрдХреНрдд рд╕реВрдЪрдирд╛ рддрд╣рд╛рдБ рдХрд╛рд░реНрдпрд╛рд▓рдпрдХреЛ рд╕реВрдЪрдирд╛ рдкрд╛рдЯреАрдорд╛ рдЯрд╛рдБрд╕ рдЧрд░реА рд╕реЛрдХреЛ рдЬрд╛рдирдХрд╛рд░реА рдкрдард╛рдЗрджрд┐рдиреБрд╣реБрди рдЕрдиреБрд░реЛрдз рдЧрд░рд┐рдиреНрдЫ ред</p>
                <table width="100%" cellpadding="0" cellspacing="0" style="font-size:14pt; border:none;">
                  <tr><td style="width:65%; vertical-align:top; text-align:justify; line-height:1.5; padding-right:15px; border:none;"><b><u>рдмреЛрдзрд╛рд░реНрде:</u></b><br>рез. рд╢реНрд░реА рдЬрд┐рд▓реНрд▓рд╛ рд╕рдордиреНрд╡рдп рд╕рдорд┐рддреАрдХреЛ рдХрд╛рд░реНрдпрд╛рд▓рдп, рд╕рд┐рдиреНрдзреБрдкрд╛рд▓реНрдЪреЛрдХ: рд╕реВрдЪрдирд╛ рдЯрд╛рдБрд╕ рдЧрд░рд┐ рдЬрд╛рдирдХрд╛рд░реА рдкрдард╛рдЗрджрд┐рдиреБрд╣реБрди ред<br></td><td style="width:35%; vertical-align:top; text-align:right; border:none;"><table align="right" cellpadding="0" cellspacing="0" style="width:220px;"><tr><td style="font-weight:bold; text-align:center;">.........................<br>${d.off}</td></tr></table></td></tr>
                  <tr><td colspan="2" style="text-align:left; line-height:1.5; border:none;">реи. рд╢реНрд░реА рдЬрд┐рд▓реНрд▓рд╛ рдирд╛рдкреА рдХрд╛рд░реНрдпрд╛рд▓рдп, рд╕рд┐рдиреНрдзреБрдкрд╛рд▓реНрдЪреЛрдХ: рд╕реВрдЪрдирд╛ рдЯрд╛рдБрд╕ рдЧрд░рд┐ рдЬрд╛рдирдХрд╛рд░реА рдкрдард╛рдЗрджрд┐рдиреБрд╣реБрди ред<br>рей. рд╢реНрд░реА ${d.loc}, рд╕рд┐рдиреНрдзреБрдкрд╛рд▓реНрдЪреЛрдХ: рд╕реВрдЪрдирд╛ рдЯрд╛рдБрд╕ рдЧрд░рд┐ рдЬрд╛рдирдХрд╛рд░реА рдкрдард╛рдЗрджрд┐рдиреБрд╣реБрди ред<br>рек. рд╢реНрд░реА ${d.sa}, рд╕рд┐рдиреНрдзреБрдкрд╛рд▓реНрдЪреЛрдХ: рд╕реВрдЪрдирд╛ рдЯрд╛рдБрд╕ рдЧрд░рд┐ рдЬрд╛рдирдХрд╛рд░реА рдкрдард╛рдЗрджрд┐рдиреБрд╣реБрди ред<br>рел. рд╢реНрд░реА ${d.papr}: рд╕реЗрд╡рд╛ рд╢реБрд▓реНрдХ рдкрддреНрд░ рдмрд╛рд╣рдХрд╕рдБрдЧ рдЕрд╕реБрд▓ рдЧрд░реА рд╕реВрдЪрдирд╛ рдкреНрд░рдХрд╛рд╢рд┐рдд рдЧрд░рд┐ рджреБрдИ рдерд╛рди рдкрддреНрд░рд┐рдХрд╛ рдкрдард╛рдЗрджрд┐рдиреБрд╣реБрди ред</td></tr>
                </table>`;
            }
            document.getElementById('dynamic_body').innerHTML = bodyHtml;
        }

        // --- WORD EXPORT ---
        async function exportAllToWord() {
            const d = getData();
            const t = generateTexts(d);

            const commonBody = `рдпрд╕рдорд╛ ${t.district} рдЬрд┐рд▓реНрд▓рд╛ ${t.address} рдмрд╕реНрдиреЗ ${t.applicantFullDesc}рд▓реЗ ${t.deathReason} ${t.ownerGrammar} рдирд╛рдордорд╛ рджрд░реНрддрд╛ рд░рд╣реЗрдХреЛ рд╕рд┐рдиреНрдзреБрдкрд╛рд▓реНрдЪреЛрдХ рдЬрд┐рд▓реНрд▓рд╛ ${t.landText} ${t.landGrammar} рдирд╛рдорд╕рд╛рд░реА рдЧрд░рд┐рдкрд╛рдЙрди рдирд┐рд╡реЗрджрди рдЧрд░реЗрдХреЛрдорд╛ ${t.ownerGrammar} рд╢реЗрд╖рдкрдЫрд┐рдХрд╛ рд╣рдХрд╡рд╛рд▓рд╛ ${t.applicantNamesOnly}рдХреЛ рдирд╛рдордорд╛ рдирд╛рдорд╕рд╛рд░реА рдЧрд░рд┐рджрд┐рди ${d.sa}рдХреЛ рдЪ.рдирдВ. ${d.sc} рдорд┐рддрд┐ ${d.sd} рдХреЛ рд╕рд┐рдлрд╛рд░рд┐рд╕рдмрд╛рдЯ рд▓реЗрдЦрд┐ рдЖрдПрдХреЛ ред${d.frk}`;
            const aadeshBody = `${commonBody} рднреВрдорд┐ рдкреНрд░рд╢рд╛рд╕рди рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛, реирежреорез рдХреЛ рджрдлрд╛ резрепреп рдХреЛ рдЙрдкрджрдлрд╛ ${d.upadafa} рдмрдореЛрдЬрд┐рдо рдердк рдкреНрд░рдорд╛рдг рдмреБрдЭреНрдиреБрдкрд░реНрдиреЗ рджреЗрдЦрд┐рдпреЛ ред рдЕрддрдГ рдЙрд▓реНрд▓рд┐рдЦрд┐рдд рдХрд┐рддреНрддрд╛ рдЬрдЧреНрдЧрд╛рдХреЛ рд╣рдХрднреЛрдЧ рдХрд╕рд▓реЗ рдЧрд░реЗрдХреЛ рдЫ ? рдирд┐рд╡реЗрджрдХрдХреЛ рдорд╛рдЧ рдмрдореЛрдЬрд┐рдо рдирд╛рдорд╕рд╛рд░реА рдЧрд░рд┐рджрд┐рдБрджрд╛ рдХреЛрд╣реА рдХрд╕реИрдХреЛ рд╣рдХрднреЛрдЧрдорд╛ рдкреНрд░рддрд┐рдХреВрд▓ рдЕрд╕рд░ рдкрд░реНрдЫ/рдкрд░реНрджреИрди? рдпрд╕ рдЕрдШрд┐ рдХреЛрд╣реА рдХрд╕реИрд▓реЗ рдирд╛рдорд╕рд╛рд░реА рд╕рдореНрдмрдиреНрдзрдорд╛ рдпрд╕ рдХрд╛рд░реНрдпрд╛рд▓рдпрдмрд╛рдЯ рдХрд╛рд░реНрдпрд╡рд╛рд╣реА рдЪрд▓рд╛рдПрдХреЛ рдЫ/рдЫреИрди? рд▓рдЧрд╛рдпрддрдХрд╛ рдЙрд▓реНрд▓рд┐рдЦрд┐рдд рд╕рдореНрдкреВрд░реНрдг рд╡реНрдпрд╣реЛрд░рд╛ рдЦреБрд▓рд╛рдИ рд╣рдХрджрд╛рд╡реА рд╕рдореНрдмрдиреНрдзрдорд╛ рейрел рджрд┐рдиреЗ рд╕рд╛рд░реНрд╡рдЬрд╛рдирд┐рдХ рд╕реВрдЪрдирд╛ рдореБрд▓реБрдХреА рджреЗрд╡рд╛рдиреА рдХрд╛рд░реНрдпрд╡рд┐рдзрд┐ рд╕рдВрд╣рд┐рддрд╛, реирежренрек рдХреЛ рджрдлрд╛ реиреореи рдмрдореЛрдЬрд┐рдо ${d.papr}рдорд╛ рд╕рдореЗрдд рдкреНрд░рдХрд╛рд╢рд┐рдд рдЧрд░реНрдиреВ ред рд╕реВрдЪрдирд╛рдХреЛ рдореНрдпрд╛рджрднрд┐рддреНрд░ рджрд╛рд╡рд┐ рдкрд░реЗ рдорд┐рд╕рд┐рд▓ рд╕рд╛рдореЗрд▓ рдЧрд░рд┐ рд░ рдирдкрд░реЗ рдореНрдпрд╛рдж рднреБрдХреНрддрд╛рди рднрдПрдкрдЫрд┐ рд╕реВрдЪрдирд╛ рдкреНрд░рдХрд╛рд╢рд┐рдд рднрдПрдХреЛ рдкрддреНрд░рд┐рдХрд╛ рд░ рд╕реВрдЪрдирд╛ рдЯрд╛рдБрд╕рдХреЛ рдЬрд╛рдирдХрд╛рд░реА рд╕рдореЗрдд рдорд┐рд╕рд┐рд▓ рд╕рд╛рдореЗрд▓ рдЧрд░реА рдкреЗрд╢ рдЧрд░реНрдиреВ ред`;
            const suchanaBody = `${commonBody} рдореГрддрдХ рдЬ.рдз.рдХреЛ рд╕реНрдпрд╛рд╣рд╛рд░ рд╕рдореНрднрд╛рд░ рдХрд╛рдЬрдХрд┐рд░рд┐рдпрд╛ рдЧрд░реНрдиреЗ рдХреЛрд╣реА рд╡реНрдпрдХреНрддрд┐ рд╡рд╛ рдЕрд░реВ рдХрд╛рдиреВрдиреА рд╣рдХрд╡рд╛рд▓рд╛ рднрдП рдпреЛ рд╕реВрдЪрдирд╛ рдкреНрд░рдХрд╛рд╢рд┐рдд рднрдПрдХреЛ рдорд┐рддрд┐рд▓реЗ рейрел рджрд┐рдирднрд┐рддреНрд░ рдЖрдлреВрд╕рдБрдЧ рднрдПрдХреЛ рд╕рдмреБрдд рдкреНрд░рдорд╛рдгрд╣рд░реВ рд╕рдВрд▓рдЧреНрди рд░рд╛рдЦреА рдЖрдлреИрдВ рд╡рд╛ рд╡рд╛рд░реЗрд╕ рдорд╛рд░реНрдлрдд рджрд╛рд╡реА/рдЙрдЬреБрд░реА рдЧрд░реНрди рдЖрдЙрдиреБрд╣реЛрд▓рд╛/рд╣рдХрджрд╛рд╡реА рдЧрд░реНрдиреБрд╣реЛрд▓рд╛ ред рдореНрдпрд╛рдж рдирд╛рдШреА рдЖрдПрдХреЛ рджрд╛рд╡реА/рдЙрдЬреБрд░реА рдЙрдкрд░ рдХреБрдиреИ рдХрд╛рд░реНрдпрд╡рд╛рд╣реА рдирд╣реБрдиреЗ рд░ рдирд┐рдпрдорд╛рдиреБрд╕рд╛рд░ рднрдИ рдЬрд╛рдиреЗ рд╡реНрдпрд╣реЛрд░рд╛ рд╕рдореЗрдд рдпрд╕реИ рд╕реВрдЪрдирд╛рджреНрд╡рд╛рд░рд╛ рдЬрд╛рдирдХрд╛рд░реА рдЧрд░рд╛рдЗрдиреНрдЫ ред`;

            const headerHTML = `
            <table style="width:100%; border:none; border-bottom: 2px double black; margin-bottom: 0px;">
                <tr>
                    <td width="15%" style="border:none; vertical-align:top;">
                        <img 
                        src="data:image/jpeg;base64,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">
                    </td>
                    <td width="85%" style="border:none; text-align:center; color:red; vertical-align:top;">
                        <p style="margin:0; font-size:10pt; font-weight:bold; line-height: 1.1;">рдиреЗрдкрд╛рд▓ рд╕рд░рдХрд╛рд░</p>
                        <p style="margin:0; font-size:11pt; font-weight:bold; line-height: 1.1;">рднреВрдорд┐ рд╡реНрдпрд╡рд╕реНрдерд╛, рд╕рд╣рдХрд╛рд░реА рддрдерд╛ рдЧрд░рд┐рдмреА рдирд┐рд╡рд╛рд░рдг рдордиреНрддреНрд░рд╛рд▓рдп</p>
                        <p style="margin:1pt 0; font-size:12pt; font-weight:bold; line-height: 1.1;">рднреВрдорд┐ рд╡реНрдпрд╡рд╕реНрдерд╛рдкрди рддрдерд╛ рдЕрднрд┐рд▓реЗрдЦ рд╡рд┐рднрд╛рдЧ</p>
                        <p style="margin:0; font-size:16pt; font-weight:bold; line-height: 1.1;">рдорд╛рд▓рдкреЛрдд рдХрд╛рд░реНрдпрд╛рд▓рдп</p>
                        <p style="margin:0; font-size:11pt; font-weight:bold; line-height: 1.1;">рдЪреМрддрд╛рд░рд╛, рд╕рд┐рдиреНрдзреБрдкрд╛рд▓реНрдЪреЛрдХ</p>
                    </td>
                </tr>
            </table>`;

            const contentAadesh = `
            <p style="text-align:center; font-weight:bold; text-decoration:underline; font-size:14pt; margin-bottom:15px; margin-top:20px;">${d.off}рдмрд╛рдЯ рдЬрд╛рд░реА рднрдПрдХреЛ рд╣рдХрджрд╛рд╡реА рд╕рдореНрдмрдиреНрдзреА рдЖрджреЗрд╢</p>
            <table style="width:100%; border-collapse:collapse; border:1px solid black; margin-top: 10px; font-size:14pt;">
                <tr><td style="width:25%; border:1px solid black; padding:10px; vertical-align:top;"><b>рдирд┐рд╡реЗрджрдХ:</b><br>${t.applicantNamesOnly}<br><br><b>рдорд┐рддрд┐:</b> ${d.dt}<br><b>рдорд┐.рдирдВ.:</b> ${d.mis}</td><td style="border:1px solid black; padding:10px; text-align:justify; line-height:1.5;">${aadeshBody}</td></tr>
            </table>`;

            const contentSuchana = `
            <p style="text-align:center; font-weight:bold; font-size:16pt; text-decoration:underline; margin-bottom:15px; margin-top:20px;">рд╣рдХрджрд╛рд╡реА рд╕рдореНрдмрдиреНрдзреА рейрел рджрд┐рдиреЗ рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рд╕реВрдЪрдирд╛</p>
            <p style="text-align:justify; font-size:14pt; text-indent:50px; line-height:1.5;">${suchanaBody}</p>`;

            const contentChithi = `
            <table style="width:100%; border:none; margin-bottom:10px; margin-top:20px; font-size:14pt;"><tr><td style="border:none;">рдкрддреНрд░ рд╕рдЩреНрдЦреНрдпрд╛: ${d.ps}<br>рдЪрд▓рд╛рдиреА рдирдВ: ${d.cn}</td><td style="border:none; text-align:right;">рдорд┐рддрд┐: ${d.dt}</td></tr></table>
            <p style="text-align:center; font-weight:bold; font-size:16pt; margin:15px 0;">рд╡рд┐рд╖рдп: рд╕реВрдЪрдирд╛ рдЯрд╛рдБрд╕ рдЧрд░реА рдЬрд╛рдирдХрд╛рд░реА рдкрдард╛рдЗрджрд┐рдиреЗ рд╕рдореНрдмрдиреНрдзрдорд╛ ред</p>
            <p style="font-weight:bold; margin-bottom:10px; font-size:14pt;">${d.tn}<br>${d.ta}</p>
            <p style="text-align:justify; text-indent:50px; line-height:1.5; font-size:14pt;">рдкреНрд░рд╕реНрддреБрдд рд╡рд┐рд╖рдпрдорд╛ рдпрд╕ рдХрд╛рд░реНрдпрд╛рд▓рдпрдмрд╛рдЯ рдкреНрд░рдХрд╛рд╢рд┐рдд ${t.district} рдЬрд┐рд▓реНрд▓рд╛ ${t.address} рдмрд╕реНрдиреЗ ${t.applicantNamesOnly}рд▓реЗ рдореГрддрдХ рдЬ.рдз. ${t.deceasedNames}рдХреЛ рдирд╛рдордорд╛ рд░рд╣реЗрдХреЛ рдЬрдЧреНрдЧрд╛ рдирд╛рдорд╕рд╛рд░реА рдЧрд░реНрдиреЗ рд╕рдореНрдмрдиреНрдзрдорд╛ рдкреНрд░рдХрд╛рд╢рд┐рдд рджрд┐рди рейрел (рдкреИрдВрддреАрд╕) рдХреЛ рд╣рдХрджрд╛рд╡реА/рдЙрдЬреБрд░реА рд╕рдореНрдмрдиреНрдзреА рд╕рд╛рд░реНрд╡рдЬрдиреАрдХ рд╕реВрдЪрдирд╛ рдерд╛рди-рез (рдПрдХ) рдпрд╕реИрд╕рд╛рде рд╕рдВрд▓рдЧреНрди рдЫ ред рдЙрдХреНрдд рд╕реВрдЪрдирд╛ рддрд╣рд╛рдБ рдХрд╛рд░реНрдпрд╛рд▓рдпрдХреЛ рд╕реВрдЪрдирд╛ рдкрд╛рдЯреАрдорд╛ рдЯрд╛рдБрд╕ рдЧрд░реА рд╕реЛрдХреЛ рдЬрд╛рдирдХрд╛рд░реА рдкрдард╛рдЗрджрд┐рдиреБрд╣реБрди рдЕрдиреБрд░реЛрдз рдЧрд░рд┐рдиреНрдЫ ред</p>
            <table width="100%" cellpadding="0" cellspacing="0" style="font-size:14pt; border:none;">
              <tr><td style="width:65%; vertical-align:top; text-align:justify; line-height:1.5; padding-right:15px; border:none;"><b><u>рдмреЛрдзрд╛рд░реНрде:</u></b><br>рез. рд╢реНрд░реА рдЬрд┐рд▓реНрд▓рд╛ рд╕рдордиреНрд╡рдп рд╕рдорд┐рддреАрдХреЛ рдХрд╛рд░реНрдпрд╛рд▓рдп, рд╕рд┐рдиреНрдзреБрдкрд╛рд▓реНрдЪреЛрдХ: рд╕реВрдЪрдирд╛ рдЯрд╛рдБрд╕ рдЧрд░рд┐ рдЬрд╛рдирдХрд╛рд░реА рдкрдард╛рдЗрджрд┐рдиреБрд╣реБрди ред<br></td><td style="width:35%; vertical-align:top; text-align:right; border:none;"><table align="right" cellpadding="0" cellspacing="0" style="width:220px;"><tr><td style="font-weight:bold; text-align:center;">.........................<br>${d.off}</td></tr></table></td></tr>
              <tr><td colspan="2" style="text-align:left; line-height:1.5; border:none;">реи. рд╢реНрд░реА рдЬрд┐рд▓реНрд▓рд╛ рдирд╛рдкреА рдХрд╛рд░реНрдпрд╛рд▓рдп, рд╕рд┐рдиреНрдзреБрдкрд╛рд▓реНрдЪреЛрдХ: рд╕реВрдЪрдирд╛ рдЯрд╛рдБрд╕ рдЧрд░рд┐ рдЬрд╛рдирдХрд╛рд░реА рдкрдард╛рдЗрджрд┐рдиреБрд╣реБрди ред<br>рей. рд╢реНрд░реА ${d.loc}, рд╕рд┐рдиреНрдзреБрдкрд╛рд▓реНрдЪреЛрдХ: рд╕реВрдЪрдирд╛ рдЯрд╛рдБрд╕ рдЧрд░рд┐ рдЬрд╛рдирдХрд╛рд░реА рдкрдард╛рдЗрджрд┐рдиреБрд╣реБрди ред<br>рек. рд╢реНрд░реА ${d.sa}, рд╕рд┐рдиреНрдзреБрдкрд╛рд▓реНрдЪреЛрдХ: рд╕реВрдЪрдирд╛ рдЯрд╛рдБрд╕ рдЧрд░рд┐ рдЬрд╛рдирдХрд╛рд░реА рдкрдард╛рдЗрджрд┐рдиреБрд╣реБрди ред<br>рел. рд╢реНрд░реА ${d.papr}: рд╕реЗрд╡рд╛ рд╢реБрд▓реНрдХ рдкрддреНрд░ рдмрд╛рд╣рдХрд╕рдБрдЧ рдЕрд╕реБрд▓ рдЧрд░реА рд╕реВрдЪрдирд╛ рдкреНрд░рдХрд╛рд╢рд┐рдд рдЧрд░рд┐ рджреБрдИ рдерд╛рди рдкрддреНрд░рд┐рдХрд╛ рдкрдард╛рдЗрджрд┐рдиреБрд╣реБрди ред</td></tr>
            </table>`;

            const pageBreak = "<br clear=all style='mso-special-character:line-break; page-break-before:always'>";
            const fullContent = `
            <html xmlns:o='urn:schemas-microsoft-com:office:office' xmlns:w='urn:schemas-microsoft-com:office:word' xmlns='http://www.w3.org/TR/REC-html40'>
            <head>
                <meta charset='utf-8'>
                <style>
                    @page Section1 { size: 8.5in 11in; margin: 1.5in 0.5in 0.5in 1.25in; mso-header-margin: 0.5in; mso-footer-margin: 0.5in; mso-header: h1; } 
                    div.Section1 { page:Section1; font-family:'Mukta', sans-serif; }
                    body { font-family:'Mukta', sans-serif; font-size: 14pt; }
                </style>
            </head>
            <body>
                <div class="Section1">
                    <div style='mso-element:header' id="h1">${headerHTML}</div>
                    ${contentAadesh}
                    ${pageBreak}
                    ${contentSuchana}
                    ${pageBreak}
                    ${contentChithi}
                </div>
            </body>
            </html>`;

            const blob = new Blob(['\ufeff', fullContent], { type: 'application/msword' });
            const link = document.createElement("a");
            link.href = URL.createObjectURL(blob);
            const fname = t.applicantNamesOnly.split(' ')[0] || "рдирд╛рдорд╕рд╛рд░реА";
            link.download = `рдирд╛рдорд╕рд╛рд░реА_(${fname}).doc`;
            link.click();
        }

        // --- LOCAL STORAGE ---
        function saveToLocal() { 
            // Save inputs
            const inputs = Array.from(document.querySelectorAll('input, select')).map(i => ({ id: i.id, val: i.value })); 
            localStorage.setItem('namsari_v4', JSON.stringify({ lands, applicants, deceasedList, inputs })); 
        }

        function loadFromLocal() {
            const raw = localStorage.getItem('namsari_v4');
            if (raw) {
                const d = JSON.parse(raw);
                lands = d.lands || [];
                applicants = d.applicants || [];
                deceasedList = d.deceasedList || [];
                if (d.inputs) d.inputs.forEach(item => { if (document.getElementById(item.id)) document.getElementById(item.id).value = item.val; });
                renderLandUI(); renderApplicantUI(); renderDeceasedUI(); updateAll();
            } else { updateAll(); }
        }

        function resetData() { 
            if (confirm("рд╕рдмреИ рдбрд╛рдЯрд╛ рдореЗрдЯрд╛рдЙрди рдЪрд╛рд╣рдиреБрд╣реБрдиреНрдЫ?")) { 
                localStorage.removeItem('namsari_v4'); 
                location.reload(); 
            } 
        }

        window.onload = loadFromLocal;
    </script>
</body>

</html>